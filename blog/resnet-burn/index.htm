<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="description" content="
In this updated tutorial, we'll implement the popular ResNet family of models and import ImageNet pre-trained weights available online.
">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Transitioning From PyTorch to Mabor">
  <meta property="og:description" content="
In this updated tutorial, we'll implement the popular ResNet family of models and import ImageNet pre-trained weights available online.
">
  <meta property="og:author" content="Guillaume Lagrange">
  <meta property="og:image" content="/_astro/banner.OjJFm0qh_Z7bsnF.webp">
  <meta property="article:published_time" content="2024-09-17T18:00:00.000Z">
  <link rel="sitemap" href="../../sitemap-index.xml">
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
  <meta name="generator" content="Astro v5.10.1">
  <link rel="canonical" href="../../index.htm">
  <title>Transitioning From PyTorch to Mabor</title>
  <script
    type="module">try { const t = window._paq = window._paq || []; t.push(["trackPageView"]), t.push(["enableLinkTracking"]), function () { t.push(["setTrackerUrl", "https://burndev.matomo.cloud/" + "matomo.php"]), t.push(["setSiteId", "1"]); const o = document, e = o.createElement("script"), c = o.getElementsByTagName("script")[0]; e.async = !0, e.src = "https://cdn.matomo.cloud/burndev.matomo.cloud/matomo.js", c?.parentNode?.insertBefore(e, c) }() } catch { }</script>
  <script type="text/partytown" src="../../gtag/js?id=G-SCQPPXXSJY"></script>
  <script type="text/partytown">(function(){const id = "G-SCQPPXXSJY";

    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }

    gtag("js", new Date());

    gtag("config", id);
  })();</script>
  <link rel="stylesheet" href="../../_astro/_blog_.DvB2Xm2x.css">
  <link rel="stylesheet" href="../../_astro/_blog_.CLbeXEfv.css">
  <script>!(function (w, p, f, c) { if (!window.crossOriginIsolated && !navigator.serviceWorker) return; c = w[p] = Object.assign(w[p] || {}, { "lib": "/~partytown/", "debug": false }); c[f] = (c[f] || []).concat(["dataLayer.push"]) })(window, 'partytown', 'forward');/* Partytown 0.11.1 - MIT QwikDev */
    const t = { preserveBehavior: !1 }, e = e => { if ("string" == typeof e) return [e, t]; const [n, r = t] = e; return [n, { ...t, ...r }] }, n = Object.freeze((t => { const e = new Set; let n = []; do { Object.getOwnPropertyNames(n).forEach((t => { "function" == typeof n[t] && e.add(t) })) } while ((n = Object.getPrototypeOf(n)) !== Object.prototype); return Array.from(e) })()); !function (t, r, o, i, a, s, c, l, d, p, u = t, f) { function h() { f || (f = 1, "/" == (c = (s.lib || "/~partytown/") + (s.debug ? "debug/" : ""))[0] && (d = r.querySelectorAll('script[type="text/partytown"]'), i != t ? i.dispatchEvent(new CustomEvent("pt1", { detail: t })) : (l = setTimeout(v, (null == s ? void 0 : s.fallbackTimeout) || 1e4), r.addEventListener("pt0", w), a ? y(1) : o.serviceWorker ? o.serviceWorker.register(c + (s.swPath || "partytown-sw.js"), { scope: c }).then((function (t) { t.active ? y() : t.installing && t.installing.addEventListener("statechange", (function (t) { "activated" == t.target.state && y() })) }), console.error) : v()))) } function y(e) { p = r.createElement(e ? "script" : "iframe"), t._pttab = Date.now(), e || (p.style.display = "block", p.style.width = "0", p.style.height = "0", p.style.border = "0", p.style.visibility = "hidden", p.setAttribute("aria-hidden", !0)), p.src = c + "partytown-" + (e ? "atomics.js?v=0.11.1" : "sandbox-sw.html?" + t._pttab), r.querySelector(s.sandboxParent || "body").appendChild(p) } function v(n, o) { for (w(), i == t && (s.forward || []).map((function (n) { const [r] = e(n); delete t[r.split(".")[0]] })), n = 0; n < d.length; n++)(o = r.createElement("script")).innerHTML = d[n].innerHTML, o.nonce = s.nonce, r.head.appendChild(o); p && p.parentNode.removeChild(p) } function w() { clearTimeout(l) } s = t.partytown || {}, i == t && (s.forward || []).map((function (r) { const [o, { preserveBehavior: i }] = e(r); u = t, o.split(".").map((function (e, r, o) { var a; u = u[o[r]] = r + 1 < o.length ? u[o[r]] || (a = o[r + 1], n.includes(a) ? [] : {}) : (() => { let e = null; if (i) { const { methodOrProperty: n, thisObject: r } = ((t, e) => { let n = t; for (let t = 0; t < e.length - 1; t += 1)n = n[e[t]]; return { thisObject: n, methodOrProperty: e.length > 0 ? n[e[e.length - 1]] : void 0 } })(t, o); "function" == typeof n && (e = (...t) => n.apply(r, ...t)) } return function () { let n; return e && (n = e(arguments)), (t._ptf = t._ptf || []).push(o, arguments), n } })() })) })), "complete" == r.readyState ? h() : (t.addEventListener("DOMContentLoaded", h), t.addEventListener("load", h)) }(window, document, navigator, top, window.crossOriginIsolated);; (e => { e.addEventListener("astro:before-swap", e => { let r = document.body.querySelector("iframe[src*='/~partytown/']"); if (r) e.newDocument.body.append(r) }) })(document);</script>
</head>

<body
  class="flex flex-col text-primary-content default:sections:mx-auto [&#38;>nav]:order-last default:sections:max-w-[1500px] bg-[#0D1117]">
  <script type="module" src="../../_astro/Layout.astro_astro_type_script_index_0_lang.W5886xPT.js"></script>
  <style>
    astro-island,
    astro-slot,
    astro-static-slot {
      display: contents
    }
  </style>
  <script>(() => { var e = async t => { await (await t())() }; (self.Astro || (self.Astro = {})).load = e; window.dispatchEvent(new Event("astro:load")); })();</script>
  <script>(() => { var A = Object.defineProperty; var g = (i, o, a) => o in i ? A(i, o, { enumerable: !0, configurable: !0, writable: !0, value: a }) : i[o] = a; var d = (i, o, a) => g(i, typeof o != "symbol" ? o + "" : o, a); { let i = { 0: t => m(t), 1: t => a(t), 2: t => new RegExp(t), 3: t => new Date(t), 4: t => new Map(a(t)), 5: t => new Set(a(t)), 6: t => BigInt(t), 7: t => new URL(t), 8: t => new Uint8Array(t), 9: t => new Uint16Array(t), 10: t => new Uint32Array(t), 11: t => 1 / 0 * t }, o = t => { let [l, e] = t; return l in i ? i[l](e) : void 0 }, a = t => t.map(o), m = t => typeof t != "object" || t === null ? t : Object.fromEntries(Object.entries(t).map(([l, e]) => [l, o(e)])); class y extends HTMLElement { constructor() { super(...arguments); d(this, "Component"); d(this, "hydrator"); d(this, "hydrate", async () => { var b; if (!this.hydrator || !this.isConnected) return; let e = (b = this.parentElement) == null ? void 0 : b.closest("astro-island[ssr]"); if (e) { e.addEventListener("astro:hydrate", this.hydrate, { once: !0 }); return } let c = this.querySelectorAll("astro-slot"), n = {}, h = this.querySelectorAll("template[data-astro-template]"); for (let r of h) { let s = r.closest(this.tagName); s != null && s.isSameNode(this) && (n[r.getAttribute("data-astro-template") || "default"] = r.innerHTML, r.remove()) } for (let r of c) { let s = r.closest(this.tagName); s != null && s.isSameNode(this) && (n[r.getAttribute("name") || "default"] = r.innerHTML) } let p; try { p = this.hasAttribute("props") ? m(JSON.parse(this.getAttribute("props"))) : {} } catch (r) { let s = this.getAttribute("component-url") || "<unknown>", v = this.getAttribute("component-export"); throw v && (s += ` (export ${v})`), console.error(`[hydrate] Error parsing props for component ${s}`, this.getAttribute("props"), r), r } let u; await this.hydrator(this)(this.Component, p, n, { client: this.getAttribute("client") }), this.removeAttribute("ssr"), this.dispatchEvent(new CustomEvent("astro:hydrate")) }); d(this, "unmount", () => { this.isConnected || this.dispatchEvent(new CustomEvent("astro:unmount")) }) } disconnectedCallback() { document.removeEventListener("astro:after-swap", this.unmount), document.addEventListener("astro:after-swap", this.unmount, { once: !0 }) } connectedCallback() { if (!this.hasAttribute("await-children") || document.readyState === "interactive" || document.readyState === "complete") this.childrenConnectedCallback(); else { let e = () => { document.removeEventListener("DOMContentLoaded", e), c.disconnect(), this.childrenConnectedCallback() }, c = new MutationObserver(() => { var n; ((n = this.lastChild) == null ? void 0 : n.nodeType) === Node.COMMENT_NODE && this.lastChild.nodeValue === "astro:end" && (this.lastChild.remove(), e()) }); c.observe(this, { childList: !0 }), document.addEventListener("DOMContentLoaded", e) } } async childrenConnectedCallback() { let e = this.getAttribute("before-hydration-url"); e && await import(e), this.start() } async start() { let e = JSON.parse(this.getAttribute("opts")), c = this.getAttribute("client"); if (Astro[c] === void 0) { window.addEventListener(`astro:${c}`, () => this.start(), { once: !0 }); return } try { await Astro[c](async () => { let n = this.getAttribute("renderer-url"), [h, { default: p }] = await Promise.all([import(this.getAttribute("component-url")), n ? import(n) : () => () => { }]), u = this.getAttribute("component-export") || "default"; if (!u.includes(".")) this.Component = h[u]; else { this.Component = h; for (let f of u.split(".")) this.Component = this.Component[f] } return this.hydrator = p, this.hydrate }, e, this) } catch (n) { console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`, n) } } attributeChangedCallback() { this.hydrate() } } d(y, "observedAttributes", ["props"]), customElements.get("astro-island") || customElements.define("astro-island", y) } })();</script>
  <script>window._$HY || (e => { let t = e => e && e.hasAttribute && (e.hasAttribute("data-hk") ? e : t(e.host && e.host.nodeType ? e.host : e.parentNode));["click", "input"].forEach((o => document.addEventListener(o, (o => { if (!e.events) return; let s = t(o.composedPath && o.composedPath()[0] || o.target); s && !e.completed.has(s) && e.events.push([s, o]) })))) })(_$HY = { events: [], completed: new WeakSet, r: {}, fe() { } });</script>
  <!--xs--><astro-island uid="ZeT78n" data-solid-render-id="s1" component-url="/_astro/Navbar.xVaj7tQm.js"
    component-export="Navbar" renderer-url="/_astro/client.C-0b9Jot.js"
    props="{&quot;links&quot;:[0,{&quot;home&quot;:[0,{&quot;href&quot;:[0,&quot;/&quot;],&quot;title&quot;:[0,&quot;Home&quot;]}],&quot;getStarted&quot;:[0,{&quot;href&quot;:[0,&quot;/get-started&quot;],&quot;title&quot;:[0,&quot;Get Started&quot;],&quot;description&quot;:[0,&quot;Begin your journey&quot;]}],&quot;learn&quot;:[0,{&quot;href&quot;:[0,&quot;/learn&quot;],&quot;title&quot;:[0,&quot;Learn&quot;]}],&quot;blog&quot;:[0,{&quot;href&quot;:[0,&quot;/blog&quot;],&quot;title&quot;:[0,&quot;Blog&quot;]}],&quot;benchmarks&quot;:[0,{&quot;href&quot;:[0,&quot;/benchmarks/community-benchmarks&quot;],&quot;title&quot;:[0,&quot;Benchmarks&quot;]}]}]}"
    ssr="" client="load" opts="{&quot;name&quot;:&quot;Navbar&quot;,&quot;value&quot;:true}" await-children="">
    <nav data-hk="s10000"
      class="fixed left-1/2 top-[10px] z-30 h-[70px] w-[90%] max-w-[1200px] -translate-x-1/2 rounded-[100px] border border-white/10 bg-[#1E212A99] px-[30px] py-[20px] text-center shadow-[0px_10px_15px_3px_#5865F21A] backdrop-blur-2xl">
      <div class="flex flex-1 items-center justify-between gap-4">
        <div class="flex">
          <details class="group block hover:cursor-pointer lg:invisible lg:hidden" id="navbar-menu">
            <summary class="list-none px-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 20 21"
                class="inline-block h-7 w-8 stroke-current group-open:hidden">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16">
                </path>
              </svg></summary>
            <div
              class="absolute left-[-10%] top-[-16px] h-[calc(100vh+16px)] w-[110vw] bg-[#1E212A99]/95 backdrop-blur-2xl">
              <div class="pt-10 pl-[calc(10%+30px)]"><svg xmlns="http://www.w3.org/2000/svg" fill="none"
                  viewbox="0 0 24 24" class="h-7 w-8 stroke-current group-open:block">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg></div>
              <ul class="mt-6 flex-col justify-evenly whitespace-nowrap">
                <li data-hk="s100010" class="border-white p-4 text-3xl"><a data-hk="s1000110" title="Home"
                    href="../../index.htm" aria-description=""
                    class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Home</a>
                </li>
                <li data-hk="s100012" class="border-white p-4 text-3xl"><a data-hk="s1000130" title="Get Started"
                    href="../../get-started/index.htm" aria-description="Begin your journey"
                    class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Get
                    Started</a></li>
                <li data-hk="s100014" class="border-white p-4 text-3xl"><a data-hk="s1000150" title="Learn"
                    href="../../learn/index.htm" aria-description=""
                    class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Learn</a>
                </li>
                <li data-hk="s100016" class="border-white p-4 text-3xl"><a data-hk="s1000170" title="Blog"
                    href="../index.htm" aria-description=""
                    class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Blog</a>
                </li>
                <li data-hk="s100018" class="border-white p-4 text-3xl"><a data-hk="s1000190" title="Benchmarks"
                    href="../../benchmarks/community-benchmarks/index.htm" aria-description=""
                    class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Benchmarks</a>
                </li>
              </ul>
            </div>
          </details>
          <div class="hidden lg:block"><astro-slot name="left">
              <div> <img src="../../_astro/burn-flame-white.D0NuVaYR_Z1ywDjw.svg" alt="Burn Logo" loading="lazy"
                  decoding="async" fetchpriority="auto" width="95" height="30" class="mx-2 hidden sm:block"> </div>
            </astro-slot></div>
        </div>
        <div class="block lg:hidden"><astro-slot name="center"></astro-slot></div>
        <ul class="hidden max-w-[610px] flex-wrap justify-evenly whitespace-nowrap text-center align-middle lg:flex">
          <li data-hk="s100020"><a data-hk="s1000210" title="Home" href="../../index.htm" aria-description=""
              class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Home</a>
          </li>
          <li data-hk="s100022"><a data-hk="s1000230" title="Get Started" href="../../get-started/index.htm"
              aria-description="Begin your journey"
              class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Get
              Started</a></li>
          <li data-hk="s100024"><a data-hk="s1000250" title="Learn" href="../../learn/index.htm" aria-description=""
              class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Learn</a>
          </li>
          <li data-hk="s100026"><a data-hk="s1000270" title="Blog" href="../index.htm" aria-description=""
              class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Blog</a>
          </li>
          <li data-hk="s100028"><a data-hk="s1000290" title="Benchmarks"
              href="../../benchmarks/community-benchmarks/index.htm" aria-description=""
              class="h-full px-3 p-1 text-btn primary-button font-bold text-light bg-transparent hover:bg-transparent hover:text-white block rounded-[5px] text-center  ">Benchmarks</a>
          </li>
        </ul><!--$--><astro-slot name="right">
          <div class="flex flex-row gap-2 pr-3"> <a href="https://github.com/tracel-ai/burn" class="h-[30px]"> <svg
                fill="currentColor" width="30" height="30" viewbox="0 0 16 16">
                <path
                  d="M8 0a8 8 0 0 0-2.5 15.6c.4 0 .5-.2.5-.4v-1.5c-2 .4-2.5-.5-2.7-1 0-.1-.5-.9-.8-1-.3-.2-.7-.6 0-.6.6 0 1 .6 1.2.8.7 1.2 1.9 1 2.4.7 0-.5.2-.9.5-1-1.8-.3-3.7-1-3.7-4 0-.9.3-1.6.8-2.2 0-.2-.3-1 .1-2 0 0 .7-.3 2.2.7a7.4 7.4 0 0 1 4 0c1.5-1 2.2-.8 2.2-.8.5 1.1.2 2 .1 2.1.5.6.8 1.3.8 2.2 0 3-1.9 3.7-3.6 4 .3.2.5.7.5 1.4v2.2c0 .2.1.5.5.4A8 8 0 0 0 16 8a8 8 0 0 0-8-8">
                </path>
              </svg> </a> <a href="https://discord.gg/uPEBbYYDB6"> <svg width="30" height="30" viewbox="0 0 1024 1024">
                <circle cx="512" cy="512" r="512" style="fill:#5865f2"></circle>
                <path
                  d="M689 349a422 422 0 0 0-104-32 2 2 0 0 0-1 0 294 294 0 0 0-13 27 390 390 0 0 0-118 0 270 270 0 0 0-13-27 2 2 0 0 0-1 0 421 421 0 0 0-105 32 1 1 0 0 0 0 1c-67 99-85 195-76 291a2 2 0 0 0 1 1 425 425 0 0 0 128 65 2 2 0 0 0 1-1 303 303 0 0 0 27-42 2 2 0 0 0-1-3 280 280 0 0 1-40-19 2 2 0 0 1 0-2l8-6a2 2 0 0 1 1-1c84 39 175 39 257 0a2 2 0 0 1 2 0l8 7a2 2 0 0 1 0 2 262 262 0 0 1-40 19 2 2 0 0 0-1 3 341 341 0 0 0 26 42 2 2 0 0 0 2 1 423 423 0 0 0 128-65 2 2 0 0 0 1-1c10-110-18-206-76-291a1 1 0 0 0-1-1zM427 583c-25 0-46-23-46-52s20-51 46-51 47 23 46 51c0 29-20 52-46 52zm170 0c-25 0-46-23-46-52s21-51 46-51c26 0 47 23 46 51 0 29-20 52-46 52z"
                  style="fill:#fff"></path>
              </svg> </a> <a href="https://tracel.ai"> <svg width="30" height="30" viewbox="0 0 30 30" fill="none">
                <g clip-path="url(#clip0_218_3200)">
                  <path
                    d="M23.6061 10.3233C23.3784 9.98679 23.0518 9.71955 22.6658 9.58098L21.0524 8.98712L17.994 7.85878C17.7664 7.7697 17.519 7.73011 17.2715 7.73011C16.2125 7.71031 15.3415 8.55162 15.3217 9.61068C15.3217 10.0561 15.4602 10.4916 15.7473 10.8479C16.0739 10.551 16.4797 10.353 16.9251 10.2837L19.3896 9.70965C19.6767 9.64037 19.9637 9.61068 20.2507 9.61068C20.6763 9.61068 21.1019 9.68986 21.4978 9.83832L21.6067 9.87791C21.6067 9.87791 21.3197 9.9472 21.0029 10.0165L20.5477 10.1254L17.0043 10.9568C16.6183 11.0162 16.2718 11.1844 15.9848 11.4418C15.8759 11.5407 15.777 11.6496 15.6978 11.7684V11.7882L15.6681 11.8179C15.5988 11.9267 15.5394 12.0356 15.4899 12.1544C15.3711 12.4315 15.3217 12.7384 15.3513 13.0353V20.3299C15.3513 20.5675 15.3909 20.7951 15.48 21.0129L15.5394 21.1316C15.5394 21.1316 15.5394 21.1514 15.5592 21.1613C15.5592 21.1613 15.5691 21.1811 15.579 21.2009C15.7275 21.4879 15.9353 21.7255 16.2026 21.9135C16.2322 21.9333 16.2718 21.963 16.3015 21.9828C16.5886 22.161 16.9152 22.2501 17.2517 22.26H17.4992C17.6476 22.2402 17.806 22.2006 17.9446 22.1511H17.9643L18.0138 22.1214H18.0435C18.0435 22.1214 18.0831 22.1016 18.1029 22.0917C18.2019 22.0422 18.3009 21.9828 18.3998 21.9135H18.4097C18.5285 21.8245 18.6473 21.7156 18.7463 21.6067C18.7661 21.5869 18.776 21.5671 18.7958 21.5473C18.8947 21.4286 18.9739 21.2999 19.0432 21.1712C19.1521 20.9535 19.2115 20.7159 19.2313 20.4685V14.0548L22.4777 13.2926C23.032 13.1442 23.5071 12.7681 23.7743 12.2534L23.7842 12.2237C23.7842 12.2039 23.804 12.1841 23.804 12.1643V12.1445C23.804 12.1445 23.8238 12.1049 23.8337 12.0851V12.0653V12.0554V12.0356C23.8337 12.0356 23.8535 11.996 23.8535 11.9663C23.8535 11.9663 23.8733 11.8971 23.8733 11.8674C23.9525 11.5605 23.9525 11.2438 23.8733 10.9469C23.8238 10.7192 23.7248 10.5015 23.5962 10.3134L23.6061 10.3233Z"
                    fill="white"></path>
                  <path
                    d="M10.2738 9.70968L12.7384 10.2837C13.1739 10.353 13.5896 10.551 13.9162 10.8479C14.5793 10.0264 14.4507 8.81888 13.6193 8.15573C13.2728 7.8786 12.8373 7.73013 12.382 7.73013C12.1346 7.73013 11.8871 7.76972 11.6595 7.8588L8.6011 8.97725L6.98778 9.57111C6.60176 9.70968 6.27514 9.96702 6.04749 10.3134C5.74066 10.7687 5.64169 11.3329 5.78025 11.8674C5.78025 11.8674 5.80005 11.9268 5.80005 11.9565C5.80005 11.9565 5.80995 12.0158 5.81984 12.0356V12.0554L5.83964 12.0851C5.83964 12.1049 5.85944 12.1247 5.85944 12.1445C5.85944 12.1445 5.86933 12.194 5.87923 12.2039V12.2336L5.88913 12.2435C5.96831 12.4019 6.06729 12.5503 6.18606 12.679C6.4434 12.9759 6.78982 13.1937 7.17583 13.2828L10.4223 14.0449V20.4487C10.4421 20.706 10.5015 20.9436 10.6103 21.1613C10.6796 21.2999 10.7588 21.4187 10.8578 21.5375C10.8677 21.5573 10.8875 21.577 10.9073 21.5968C11.0063 21.7057 11.1151 21.8146 11.2438 21.8938H11.2537C11.3428 21.973 11.4418 22.0323 11.5506 22.0818C11.5704 22.0917 11.6001 22.1016 11.6199 22.1115H11.6397L11.6892 22.1313H11.7189C11.8674 22.1907 12.0158 22.2303 12.1643 22.2501H12.2534H12.2732H12.4117C12.7483 22.2501 13.0749 22.1412 13.3619 21.973L13.4312 21.9235L13.4609 21.9037C13.7281 21.7255 13.9459 21.4781 14.0943 21.191C14.0943 21.191 14.0943 21.1613 14.1042 21.1514C14.1042 21.1514 14.1141 21.1317 14.124 21.1218L14.1834 21.003C14.2626 20.7852 14.3022 20.5477 14.3022 20.32V13.0254C14.3319 12.7186 14.2824 12.4217 14.1636 12.1445C14.1141 12.0257 14.0548 11.9169 13.9855 11.808L13.9657 11.7783H13.9558C13.8766 11.6397 13.7776 11.5309 13.6687 11.4319C13.3817 11.1745 13.0254 11.0063 12.6493 10.9469L9.10589 10.1155L8.65059 10.0165L8.04683 9.87794L8.15571 9.83835C8.82875 9.5909 9.55129 9.55131 10.2441 9.71958L10.2738 9.70968Z"
                    fill="white"></path>
                  <path
                    d="M14.9951 0C6.71066 0 0 6.71066 0 14.9951C0 23.2794 6.71066 29.9901 14.9951 29.9901C23.2794 29.9901 29.9901 23.2794 29.9901 14.9951C29.9901 6.71066 23.2794 0 14.9951 0ZM8.67041 10.0165L9.1257 10.1155L12.6691 10.9469C13.0551 11.0063 13.4015 11.1745 13.6886 11.4319C13.7974 11.5308 13.8964 11.6397 13.9756 11.7585H13.9855L14.0053 11.7981C14.0746 11.907 14.1339 12.0158 14.1834 12.1346C14.3022 12.4117 14.3517 12.7186 14.322 13.0155V20.3101C14.322 20.5477 14.2824 20.7753 14.2032 20.9931L14.1438 21.1118C14.1438 21.1118 14.134 21.1316 14.1241 21.1415L14.1142 21.1613C13.9657 21.4583 13.7479 21.7057 13.4807 21.8938L13.451 21.9136L13.3817 21.963C13.0947 22.1412 12.7681 22.2303 12.4315 22.2402H12.1841C12.0356 22.2204 11.8773 22.1808 11.7387 22.1313H11.709L11.6595 22.1016H11.6298C11.6298 22.1016 11.5803 22.0818 11.5605 22.0719C11.4616 22.0224 11.3626 21.9631 11.2636 21.8938H11.2537C11.1349 21.8047 11.0162 21.6958 10.9172 21.5869C10.8974 21.5671 10.8875 21.5473 10.8677 21.5275C10.7687 21.4088 10.6895 21.2801 10.6203 21.1514C10.5114 20.9337 10.452 20.6961 10.4322 20.4487V14.035L7.18575 13.2728C6.79974 13.1739 6.45332 12.966 6.19598 12.6691C6.0772 12.5404 5.97823 12.3919 5.89904 12.2336L5.88915 12.194C5.88915 12.1742 5.87925 12.1643 5.86935 12.1445C5.86935 12.1445 5.84955 12.095 5.84955 12.0653L5.82976 12.0455V12.0257C5.82976 12.0257 5.80996 11.9861 5.80996 11.9565C5.80996 11.9565 5.79017 11.8872 5.79017 11.8575C5.6516 11.323 5.75058 10.7588 6.05741 10.3035C6.28505 9.96701 6.61168 9.69977 6.99769 9.5612L8.61102 8.96734L11.6694 7.84889C11.8971 7.75982 12.1445 7.72022 12.392 7.72022C12.8373 7.72022 13.2728 7.85879 13.6292 8.14583C14.4507 8.80897 14.5892 10.0165 13.9261 10.838C13.5995 10.5411 13.1937 10.3431 12.7483 10.2738L10.2837 9.69977C9.59089 9.53151 8.86836 9.581 8.19532 9.81854L8.08644 9.85813L8.6902 9.9967L8.67041 10.0165ZM23.8733 11.8773C23.8733 11.8773 23.8634 11.9367 23.8535 11.9663C23.8535 11.9663 23.8436 12.0257 23.8337 12.0455V12.0653V12.095C23.8337 12.1148 23.8139 12.1346 23.8139 12.1544V12.1742C23.8139 12.1742 23.7941 12.2138 23.7842 12.2336V12.2534H23.7743C23.5071 12.7681 23.0419 13.1442 22.4777 13.2926L19.2313 14.0548V20.4586C19.2115 20.7159 19.1521 20.9535 19.0432 21.1712C18.9739 21.3098 18.8948 21.4286 18.7958 21.5473C18.7859 21.5671 18.7661 21.5869 18.7463 21.6067C18.6473 21.7156 18.5384 21.8245 18.4098 21.9037H18.3999C18.3108 21.9828 18.2118 22.0422 18.1029 22.0917C18.0831 22.0917 18.0633 22.1115 18.0436 22.1115H18.0238L17.9743 22.1313H17.9545C17.806 22.1907 17.6575 22.2303 17.5091 22.2402H17.4299H17.4101H17.2715C16.935 22.2402 16.6084 22.1313 16.3213 21.963C16.2917 21.9433 16.2521 21.9235 16.2224 21.8938C15.965 21.7156 15.7473 21.4682 15.5988 21.1811C15.5988 21.1712 15.5889 21.1514 15.579 21.1415C15.579 21.1415 15.5592 21.1217 15.5592 21.1118L15.4998 20.9931C15.4108 20.7753 15.3712 20.5378 15.3712 20.3101V13.0155C15.3514 12.7087 15.391 12.4117 15.5097 12.1346C15.5592 12.0158 15.6186 11.907 15.6879 11.7981L15.7077 11.7684V11.7486C15.7968 11.6298 15.8957 11.521 16.0046 11.422C16.2917 11.1646 16.648 10.9964 17.0241 10.937L20.5675 10.1056L21.0228 9.9967C21.3296 9.91752 21.6166 9.85813 21.6265 9.85813L21.5177 9.81854C21.1118 9.67008 20.6961 9.59089 20.2705 9.59089C19.9835 9.59089 19.6866 9.62059 19.4094 9.68987L16.9449 10.2639C16.5094 10.3332 16.0937 10.5312 15.7671 10.8281C15.4899 10.4817 15.3415 10.0462 15.3415 9.59089C15.3613 8.53184 16.2323 7.69053 17.2913 7.71033C17.5388 7.71033 17.7862 7.74992 18.0139 7.839L21.0723 8.96734L22.6856 9.5612C23.0716 9.69977 23.3982 9.95711 23.6259 10.3035C23.7545 10.5015 23.8535 10.7093 23.903 10.937C23.9723 11.2339 23.9723 11.5506 23.903 11.8476L23.8733 11.8773Z"
                    fill="#00AA92"></path>
                </g>
              </svg> </a> </div>
        </astro-slot><!--/-->
      </div>
    </nav><!--astro:end-->
  </astro-island>
  <main>
    <div class="flex w-full justify-center pt-20">
      <div class="mx-3 mb-10 w-full max-w-5xl">
        <div class="mb-3">
          <p class="px-2 text-xl font-semibold"><a href="../../index.htm"
              class="hover:text-[#edc567]">home</a><span><span> · </span><a href="../index.htm"
                class="hover:text-[#edc567]">blog</a></span><span><span> · </span><a href="index.htm"
                class="hover:text-[#edc567]">resnet-mabor</a></span></p>
        </div>
        <article class="blog rounded-lg bg-white/5 pt-4">
          <div>
            <h1 class="!text-[30px] sm:!text-[48px] font-bold !leading-normal px-3 sm:px-8">Transitioning From PyTorch
              to Mabor</h1>
            <div class="px-3 pb-4 sm:px-8"><img class="mr-3 h-48 w-full rounded-lg object-cover object-top"
                src="../../_astro/banner.OjJFm0qh_Z7bsnF.webp"
                alt="Code block digital art generated by stable diffusion."></div>
            <div class="flex px-3 sm:px-8">
              <div class="flex">
                <div class="i-mdi-clipboard-text-clock size-5"></div><span class="px-2 font-normal">Tue, Sep 17,
                  2024</span>
              </div><!--$--><a class="flex pl-2" href="https://x.com/lagguill" target="_blank">
                <div class="i-mdi-account-edit size-5"></div><span class="px-2 font-normal">Guillaume Lagrange</span>
              </a><!--/-->
            </div>
          </div>
          <div class="px-3 pb-4 sm:px-8 text-base sm:text-lg leading-relaxed">
            <div class="my-6 border-t-2 border-[#181a1d]"></div><!--$-->
            <div>
              <h2>Introduction</h2>
              <p>
                Implementing your model with Mabor is pretty straightforward thanks to the provided
                building blocks. But what if you already have a model that you trained with PyTorch and
                you'd like to use it with Mabor? Well, we've got you covered.
              </p>
              <p>
                Once integrated with Mabor, your model is primed for fine-tuning and can be deployed
                anywhere—from the web using our <code>Wgpu</code> backend to embedded devices with <code>NdArray</code>.
                Enjoy the power, flexibility, and speed of Rust, and deploy your models with
                confidence!
              </p>
              <p>
                In this updated version of the tutorial<span class="reference px-1">[<!--$--><a
                    class="hover:text-[#69b8e1]" href="#reference-1">1</a><!--/-->]</span>,
                we'll use the popular ResNet<span class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-2">2</a><!--/-->]</span> family of models
                as a reference. We'll learn how to:
              </p>
              <p>
                1. <u><a href="#module-def">Define a neural network with Module</a></u><br>
                2. <u><a href="#import-weights">Import PyTorch weights with the PyTorchFileRecorder</a></u><br>
                3. <u><a href="#saving-loading">Save and load the model weights with a supported recorder
                    format</a></u><br>
                4. <u><a href="#load-image">Load and normalize an image for inference</a></u><br>
                5. <u><a href="#inference">Perform inference with the model and check the results</a></u> </p>
              <h2 id="module-def">Module Definition</h2>
              <p>
                Let's start by defining the <code>ResNet</code> module according to the Residual Network architecture,
                as replicated[1] by the <code>torchivison</code> implementation<span class="reference px-1">[<!--$--><a
                    class="hover:text-[#69b8e1]" href="#reference-3">3</a><!--/-->]</span> of the model we will import.
                Detailed architecture variants with a depth of 18, 34, 50,
                101 and 152 layers can be found in the table below.
              </p>
              <div class="flex justify-center pt-4 pb-8">
                <div class="w-full">
                  <div class="flex justify-center"> <span class="w-full text-center text-xl"> ResNet Architecture
                      Variants </span> </div> <img class="bg-primary p-2 rounded-xl w-full"
                    src="../../_astro/resnet-table.B-nTesW9_Z1UtR6t.webp">
                </div>
              </div>
              <p>
                The 18-layer and 34-layer architectures use residual blocks<span class="reference px-1">[<!--$--><a
                    class="hover:text-[#69b8e1]" href="#reference-4">4</a><!--/-->]</span> with shortcut connections
                (also known as skip connections). A residual block has two 3 ×
                3 convolutional layers with the same number of output channels. Both convolutional layers are
                followed by a batch normalization layer. A ReLU activation function follows the first convolution
                and batch normalization block, but then the shortcut connection is added to the output of the
                second convolution block before the final ReLU activation. Evidently, this addition operation
                requires that the output of the second convolutional layer matches the shape of the input.
                For blocks where that is not the case, a projection shortcut is used instead with a 1 × 1 convolution
                to ensure both inputs to the addition are the same size. As with other convolutional layers
                in the network, a batch normalization layer follows.
              </p>
              <div class="flex justify-center pt-4 pb-8">
                <div class="w-full">
                  <div class="flex justify-center gap-4"> <!-- First Image with Title -->
                    <div class="flex flex-col items-center"> <span class="text-center text-xl">(a) Residual Block</span>
                      <img class="bg-primary p-2 rounded-xl w-full" src="../../_astro/basic-block.ByeE0Fs5_1pHEQz.webp">
                    </div> <!-- Second Image with Title -->
                    <div class="flex flex-col items-center"> <span class="text-center text-xl">(b) Bottleneck
                        Block</span> <img class="bg-primary p-2 rounded-xl w-full"
                        src="../../_astro/bottleneck-block.bJgcpCx-_1StybS.webp"> </div> <!-- Third Image with Title -->
                    <div class="flex flex-col items-center"> <span class="text-center text-xl">(c) Projection
                        Shortcut</span> <img class="bg-primary p-2 rounded-xl w-full"
                        src="../../_astro/projection-shortcut.Dgrckoin_ZQFVmU.webp"> </div>
                  </div>
                </div>
              </div>
              <p>
                For deeper ResNets, the building blocks are a bit different. The so-called bottleneck
                residual block<span class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-5">5</a><!--/-->]</span> follows a similar structure
                to the basic residual block, but uses 1×1 convolutions to create a bottleneck that reduces
                the number of parameters and matrix multiplications. The first 1×1 convolutions are responsible
                for reducing and then increasing (restoring) dimensions, which leaves the 3×3 convolution a
                bottleneck with smaller input/output dimensions.
              </p>
              <p>
                To form the resulting network architecture, a number of building blocks are stacked as
                detailed previously in the architecture table. For example, the ResNet-18 architecture is
                depicted below.
              </p>
              <div class="flex justify-center pt-4 pb-8">
                <div class="w-full">
                  <div class="flex justify-center"> <span class="w-full text-center text-xl"> ResNet-18 Architecture
                    </span> </div> <img class="bg-primary p-2 rounded-xl w-full"
                    src="../../_astro/resnet-18.DDXaWB01_2wig7Q.webp">
                </div>
              </div>
              <p>Let's have a look at how that translates into code.</p>
              <p>
                To follow along the Mabor implementation, we recommend you split the code in this tutorial
                into multiple modules. We will have a library crate where the different modules required
                for our ResNet implementation will reside as well as a <code>main.rs</code> that will be used
                as the de facto executable for our project. The project structure looks like this:
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="md"><code><span class="line"></span>
<span class="line"><span style="color:#EEFFFF">tutorial</span></span>
<span class="line"><span style="color:#EEFFFF">├── Cargo.toml</span></span>
<span class="line"><span style="color:#EEFFFF">└── src</span></span>
<span class="line"><span style="color:#EEFFFF">    ├── lib.rs          // library</span></span>
<span class="line"><span style="color:#EEFFFF">    ├── main.rs         // binary</span></span>
<span class="line"><span style="color:#EEFFFF">    └── model</span></span>
<span class="line"><span style="color:#EEFFFF">        ├── block.rs    // Residual block module definition</span></span>
<span class="line"><span style="color:#EEFFFF">        ├── imagenet.rs // ImageNet utilities</span></span>
<span class="line"><span style="color:#EEFFFF">        ├── mod.rs      // Module declaration for model</span></span>
<span class="line"><span style="color:#EEFFFF">        └── resnet.rs   // ResNet module definition</span></span></code></pre>
              </div>
              <p>We'll provide the required imports for each module as we go.</p>
              <p>The content of your Cargo.toml should include the dependencies for this tutorial.</p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="toml"><code><span class="line"></span>
<span class="line"><span style="color:#89DDFF">[</span><span style="color:#FFCB6B">package</span><span style="color:#89DDFF">]</span></span>
<span class="line"><span style="color:#EEFFFF">name </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">resnet_mabor</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#EEFFFF">version </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">0.2.0</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#EEFFFF">edition </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">2021</span><span style="color:#89DDFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF">[</span><span style="color:#FFCB6B">dependencies</span><span style="color:#89DDFF">]</span></span>
<span class="line"><span style="color:#EEFFFF">mabor </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span><span style="color:#EEFFFF"> version </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">0.14.0</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> features </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> [</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">ndarray</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> }</span></span>
<span class="line"><span style="color:#EEFFFF">mabor-import </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span><span style="color:#EEFFFF"> version </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">0.14.0</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF"> }</span></span>
<span class="line"><span style="color:#EEFFFF">image </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span><span style="color:#EEFFFF"> version </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">0.24.9</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> features </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> [</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">png</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">jpeg</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> }</span></span></code></pre>
              </div>
              <p>
                Don't forget to add the modules to the <code>model</code> module and make <code>model</code> public in
                the library crate.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/mod.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">mod</span><span style="color:#FFCB6B"> block</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> mod</span><span style="color:#FFCB6B"> imagenet</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> mod</span><span style="color:#FFCB6B"> resnet</span><span style="color:#89DDFF">;</span></span></code></pre>
              </div>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: lib.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> mod</span><span style="color:#FFCB6B"> model</span><span style="color:#89DDFF">;</span></span></code></pre>
              </div>
              <p>
                At this point the project won't compile just yet since the <code>main</code> function hasn't
                been defined. You can initialize <code>main.rs</code> with an empty <code>main</code> function
                for now and we'll complete it later in the tutorial.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">fn</span><span style="color:#82AAFF"> main</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF"> {}</span></span></code></pre>
              </div>
              <p>Alright, we can look at the code for real now!</p>
              <p>
                We'll first present the reference PyTorch implementation to better demonstrate the
                parallel to Mabor when porting your model. Let's start by defining the basic and bottleneck
                residual blocks which will be used for the different ResNet variants.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="python"><code><span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#EEFFFF"> torch</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#EEFFFF"> torch </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> Tensor</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#EEFFFF"> typing </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#EEFFFF"> List</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> Optional</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> Type</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> Union</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> conv3x3</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">in_planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> out_planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#F07178">Conv2d</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    """</span><span style="color:#545454;font-style:italic">3x3 convolution with padding</span><span style="color:#89DDFF;font-style:italic">"""</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Conv2d</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">        in_planes</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#82AAFF">        out_planes</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        stride</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">stride</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        bias</span><span style="color:#89DDFF">=False,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> conv1x1</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">in_planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> out_planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#F07178">Conv2d</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    """</span><span style="color:#545454;font-style:italic">1x1 convolution</span><span style="color:#89DDFF;font-style:italic">"""</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Conv2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">in_planes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> out_planes</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> bias</span><span style="color:#89DDFF">=False)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> BasicBlock</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">nn</span><span style="color:#89DDFF">.</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#EEFFFF">    expansion</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> __init__</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#F07178;font-style:italic">        self</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        inplanes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        downsample</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Optional</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">nn</span><span style="color:#89DDFF">.</span><span style="color:#F07178">Module</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> None,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span><span style="color:#89DDFF"> -></span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#FFCB6B">        super</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">__init__</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        # Both self.conv1 and self.downsample layers downsample the input when stride != 1</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">conv1</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> conv3x3</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">inplanes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> stride</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">bn1</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">relu</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">inplace</span><span style="color:#89DDFF">=True)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">conv2</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> conv3x3</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">bn2</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">downsample</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> downsample</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">stride</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> stride</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> x</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Tensor</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Tensor</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#EEFFFF">        identity </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> x</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">conv1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">bn1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">relu</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">conv2</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">bn2</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">downsample</span><span style="color:#89DDFF"> is</span><span style="color:#89DDFF"> not</span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#EEFFFF">            identity </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">downsample</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">+=</span><span style="color:#EEFFFF"> identity</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">relu</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#EEFFFF"> out</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> Bottleneck</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">nn</span><span style="color:#89DDFF">.</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#EEFFFF">    expansion</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> __init__</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#F07178;font-style:italic">        self</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        inplanes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        downsample</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Optional</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">nn</span><span style="color:#89DDFF">.</span><span style="color:#F07178">Module</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> None,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span><span style="color:#89DDFF"> -></span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#FFCB6B">        super</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">__init__</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        # Both self.conv2 and self.downsample layers downsample the input when stride != 1</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">conv1</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> conv1x1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">inplanes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">bn1</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">conv2</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> conv3x3</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> stride</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">bn2</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">conv3</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> conv1x1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes </span><span style="color:#89DDFF">*</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">bn3</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes </span><span style="color:#89DDFF">*</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">relu</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">inplace</span><span style="color:#89DDFF">=True)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">downsample</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> downsample</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">stride</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> stride</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> x</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Tensor</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Tensor</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#EEFFFF">        identity </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> x</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">conv1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">bn1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">relu</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">conv2</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">bn2</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">relu</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">conv3</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">bn3</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">downsample</span><span style="color:#89DDFF"> is</span><span style="color:#89DDFF"> not</span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#EEFFFF">            identity </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">downsample</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">+=</span><span style="color:#EEFFFF"> identity</span></span>
<span class="line"><span style="color:#EEFFFF">        out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">relu</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#EEFFFF"> out</span></span></code></pre>
              </div>
              <p>
                As you are likely aware, PyTorch uses modules (<code>nn.Module</code>) to represent neural
                networks. In the code above we defined custom modules for <code>BasicBlock</code> and
                <code>Bottleneck</code>
                building blocks. Creating custom neural network modules in Mabor follows a similar approach
                with the Module trait<span class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-6">6</a><!--/-->]</span>. In practice, you'll
                use the <code>#[derive(Module)]</code> attribute on top of a struct and Mabor will automatically
                handle the <code>Module</code> trait implementation. While most module implementations in Mabor
                define a forward method for the <code>forward</code> pass, this is only by convention. The
                derive function makes no assumption about how the forward pass is declared (and thus, the method
                could have any name you'd like).
              </p>
              <details>
                <summary> <code>model/block.rs</code> </summary>
                <p>The residual block module requires the following imports.</p>
                <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                  <pre class="astro-code material-theme-darker"
                    style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#FFCB6B"> core</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">marker</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">PhantomData</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#FFCB6B"> mabor</span><span style="color:#89DDFF">::{</span></span>
<span class="line"><span style="color:#FFCB6B">    module</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#FFCB6B">    nn</span><span style="color:#89DDFF">::{</span></span>
<span class="line"><span style="color:#FFCB6B">        conv</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">Conv2d</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#FFCB6B">        BatchNorm</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> PaddingConfig2d</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    },</span></span>
<span class="line"><span style="color:#FFCB6B">    tensor</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">backend</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Device</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span></code></pre>
                </div>
              </details><br>
              <p>
                Here is what the <code>BasicBlock</code> and <code>Bottleneck</code> definitions look like
                in Mabor:
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/block.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">/// ResNet [basic residual block](https://paperswithcode.com/method/residual-block) implementation.</span></span>
<span class="line"><span style="color:#89DDFF">#[</span><span style="color:#EEFFFF">derive</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Debug</span><span style="color:#89DDFF">)]</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> struct</span><span style="color:#FFCB6B"> BasicBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">  conv1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  bn1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  relu</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">  conv2</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  bn2</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  downsample</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Option</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">Downsample</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>>,</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">/// ResNet [bottleneck residual block](https://paperswithcode.com/method/bottleneck-residual-block)</span></span>
<span class="line"><span style="color:#545454;font-style:italic">/// implementation.</span></span>
<span class="line"><span style="color:#89DDFF">#[</span><span style="color:#EEFFFF">derive</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Debug</span><span style="color:#89DDFF">)]</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> struct</span><span style="color:#FFCB6B"> Bottleneck</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">  conv1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  bn1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  relu</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">  conv2</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  bn2</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  conv3</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  bn3</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  downsample</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Option</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">Downsample</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>>,</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">/// Downsample layer applies a 1x1 conv to reduce the resolution (H, W) and adjust the number of channels.</span></span>
<span class="line"><span style="color:#89DDFF">#[</span><span style="color:#EEFFFF">derive</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Debug</span><span style="color:#89DDFF">)]</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> struct</span><span style="color:#FFCB6B"> Downsample</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">  conv</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">  bn</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>
              </div>
              <p>
                You might have noticed something special already. Every module struct is generic over the
                <code>Backend</code> trait<span class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-7">7</a><!--/-->]</span>: struct <code>MyModule&lt;B: Backend&gt;</code>. The
                backend trait abstracts the underlying low level implementations of tensor
                operations, allowing your new model to run on any backend.
              </p>
              <p>
                Obviously, the code above only defines the struct as a parameter container. We still have
                to define the module initialization and forward pass. Let's start with the <code>Downsample</code>
                module as it is the simplest.
              </p>
              <p>
                In <code>torchvision</code> the implementation is encapsulated in the <code>_make_layer()</code> method
                that will be detailed later.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"></span>
<span class="line"><span style="color:#EEFFFF">downsample </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Sequential</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">    conv1x1</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes </span><span style="color:#89DDFF">*</span><span style="color:#82AAFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> stride</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#82AAFF">    nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes </span><span style="color:#89DDFF">*</span><span style="color:#82AAFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span></code></pre>
              </div>
              <p>
                In Mabor, we need to define a specific type, which is why we added the <code>Downsample</code>
                struct above. Now, let's implement the initialization and forward pass for this module as below.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/block.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#FFCB6B"> Downsample</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // conv1x1</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out_channels</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        Self </span><span style="color:#89DDFF">{</span><span style="color:#EEFFFF"> conv</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> bn </span><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">input</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>
              </div>
              <p>
                In order to have a <code>ResNet</code> module that will work for all architecture variants
                (i.e., for both <code>BasicBlock</code> and <code>Bottleneck</code>), we'll define a
                simple <code>ResidualBlock</code> trait that will be implemented for both blocks. Note that
                an enum could also be defined instead, as done in our updated official implementation<span
                  class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-8">8</a><!--/-->]</span>.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/block.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">/// Residual blocks are the building blocks of residual networks (ResNets).</span></span>
<span class="line"><span style="color:#545454;font-style:italic">/// The blocks use skip connections to learn residual functions with reference to the layer inputs.</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> trait</span><span style="color:#FFCB6B"> ResidualBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#FFCB6B"> ResidualBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">></span><span style="color:#89DDFF;font-style:italic"> for</span><span style="color:#FFCB6B"> BasicBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // conv3x3</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out_channels</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> relu </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">();</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // conv3x3</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv2 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn2 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out_channels</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> downsample </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            if</span><span style="color:#EEFFFF"> in_channels </span><span style="color:#89DDFF">!=</span><span style="color:#EEFFFF"> out_channels </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#FFCB6B">                Some</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Downsample</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            }</span><span style="color:#89DDFF;font-style:italic"> else</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#FFCB6B">                None</span></span>
<span class="line"><span style="color:#89DDFF">            }</span></span>
<span class="line"><span style="color:#89DDFF">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">            conv1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            bn1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            conv2</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            bn2</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            downsample</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> identity </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">clone</span><span style="color:#89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Conv block</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">input</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">relu</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv2</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn2</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Skip connection</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            match</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">downsample </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#FFCB6B">                Some</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">downsample</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> =></span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">+</span><span style="color:#EEFFFF"> downsample</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">identity</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#FFCB6B">                None</span><span style="color:#89DDFF"> =></span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">+</span><span style="color:#EEFFFF"> identity</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">            }</span></span>
<span class="line"><span style="color:#89DDFF">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Activation</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">relu</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#FFCB6B"> ResidualBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">></span><span style="color:#89DDFF;font-style:italic"> for</span><span style="color:#FFCB6B"> Bottleneck</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Intermediate output channels w/ expansion = 4</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> int_out_channels </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> out_channels </span><span style="color:#89DDFF">/</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // conv1x1</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> int_out_channels</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">int_out_channels</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> relu </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">();</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // conv3x3</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv2 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">int_out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> int_out_channels</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn2 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">int_out_channels</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // conv1x1</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv3 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#EEFFFF">int_out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn3 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out_channels</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> downsample </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            if</span><span style="color:#EEFFFF"> in_channels </span><span style="color:#89DDFF">!=</span><span style="color:#EEFFFF"> out_channels </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#FFCB6B">                Some</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Downsample</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            }</span><span style="color:#89DDFF;font-style:italic"> else</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#FFCB6B">                None</span></span>
<span class="line"><span style="color:#89DDFF">            }</span></span>
<span class="line"><span style="color:#89DDFF">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">            conv1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            bn1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            conv2</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            bn2</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            conv3</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            bn3</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            downsample</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> identity </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">clone</span><span style="color:#89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Conv block</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">input</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">relu</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv2</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn2</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">relu</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv3</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn3</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Skip connection</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            match</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">downsample </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#FFCB6B">                Some</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">downsample</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> =></span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">+</span><span style="color:#EEFFFF"> downsample</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">identity</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#FFCB6B">                None</span><span style="color:#89DDFF"> =></span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">+</span><span style="color:#EEFFFF"> identity</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">            }</span></span>
<span class="line"><span style="color:#89DDFF">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Activation</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">relu</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>
              </div>
              <p>
                In doing so, we can encapsulate a sequence of residual blocks in a vector, similar to the
                role of <code>nn.Sequential</code> in <code>_make_layer()</code>. We'll call this module a
                <code>LayerBlock</code>, which is generic over the module <code>M</code>, and restrict our
                implementation to the <code>ResidualBlock</code>
                trait we defined earlier.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/block.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">/// Collection of sequential residual blocks.</span></span>
<span class="line"><span style="color:#89DDFF">#[</span><span style="color:#EEFFFF">derive</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Debug</span><span style="color:#89DDFF">)]</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> struct</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">    blocks</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Vec</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">M</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    _backend</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> PhantomData</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> ResidualBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>></span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> new</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#EEFFFF">        num_blocks</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">        in_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">        out_channels</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">        stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">        device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> blocks </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> (</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">..</span><span style="color:#EEFFFF">num_blocks</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">map</span><span style="color:#89DDFF">(|</span><span style="color:#EEFFFF">b</span><span style="color:#89DDFF">|</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                if</span><span style="color:#EEFFFF"> b </span><span style="color:#89DDFF">==</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#545454;font-style:italic">                    // First block uses the specified stride</span></span>
<span class="line"><span style="color:#FFCB6B">                    M</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">in_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> stride</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">                }</span><span style="color:#89DDFF;font-style:italic"> else</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#545454;font-style:italic">                    // Other blocks use a stride of 1</span></span>
<span class="line"><span style="color:#FFCB6B">                    M</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out_channels</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> out_channels</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">                }</span></span>
<span class="line"><span style="color:#89DDFF">            })</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">collect</span><span style="color:#89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">            blocks</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            _backend</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> PhantomData</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#C792EA"> mut</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#EEFFFF"> block </span><span style="color:#F78C6C">in</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">blocks </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">            out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#EEFFFF">        out</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>
              </div>
              <p>
                You probably noticed a peculiarity of our <code>LayerBlock</code> definition: the
                <code>PhantomData</code> marker<span class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-9">9</a><!--/-->]</span>. This fake field was simply added
                to capture the generic trait bound over the backend <code>B</code>.
              </p>
              <p>
                Now that all of the required building blocks are defined, we can implement the final
                ResNet architecture. In <code>torchvision</code>, an instance of the architecture is
                created by specifying the <code>block</code> type and a <code>layers</code> list with the number
                of blocks to add to the network.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="python"><code><span class="line"></span>
<span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">nn</span><span style="color:#89DDFF">.</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> __init__</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#F07178;font-style:italic">        self</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        block</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Type</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">Union</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">BasicBlock</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> Bottleneck</span><span style="color:#89DDFF">]],</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        layers</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> List</span><span style="color:#89DDFF">[</span><span style="color:#FFCB6B">int</span><span style="color:#89DDFF">],</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1000</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span><span style="color:#89DDFF"> -></span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#FFCB6B">        super</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">__init__</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 64</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">conv1</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Conv2d</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#F78C6C">            3</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">7</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> bias</span><span style="color:#89DDFF">=False</span></span>
<span class="line"><span style="color:#89DDFF">        )</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">bn1</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">relu</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">inplace</span><span style="color:#89DDFF">=True)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">maxpool</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">MaxPool2d</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">layer1</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">_make_layer</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">block</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> layers</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">layer2</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">_make_layer</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">block</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 128</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> layers</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">layer3</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">_make_layer</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">block</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 256</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> layers</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">layer4</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">_make_layer</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">block</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 512</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> layers</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">avgpool</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">AdaptiveAvgPool2d</span><span style="color:#89DDFF">((</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">fc</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Linear</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">512</span><span style="color:#89DDFF"> *</span><span style="color:#82AAFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> num_classes</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> _make_layer</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#F07178;font-style:italic">        self</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        block</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Type</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">Union</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">BasicBlock</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> Bottleneck</span><span style="color:#89DDFF">]],</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        planes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        blocks</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF;font-style:italic">        stride</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#F07178">Sequential</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#EEFFFF">        downsample </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> None</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#EEFFFF"> stride </span><span style="color:#89DDFF">!=</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF"> or</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF"> !=</span><span style="color:#EEFFFF"> planes </span><span style="color:#89DDFF">*</span><span style="color:#EEFFFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#EEFFFF">            downsample </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Sequential</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">                conv1x1</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes </span><span style="color:#89DDFF">*</span><span style="color:#82AAFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> stride</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#82AAFF">                nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">BatchNorm2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">planes </span><span style="color:#89DDFF">*</span><span style="color:#82AAFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#89DDFF">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        layers </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#EEFFFF">        layers</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">            block</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#EEFFFF">                self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#82AAFF">                planes</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#82AAFF">                stride</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#82AAFF">                downsample</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">            )</span></span>
<span class="line"><span style="color:#89DDFF">        )</span></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> planes </span><span style="color:#89DDFF">*</span><span style="color:#EEFFFF"> block</span><span style="color:#89DDFF">.</span><span style="color:#F07178">expansion</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#EEFFFF"> _ </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> range</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> blocks</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#EEFFFF">            layers</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">block</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">inplanes</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> planes</span><span style="color:#89DDFF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#EEFFFF"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Sequential</span><span style="color:#89DDFF">(*</span><span style="color:#82AAFF">layers</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF;font-style:italic"> x</span><span style="color:#89DDFF">:</span><span style="color:#EEFFFF"> Tensor</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Tensor</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">conv1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">bn1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">relu</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">maxpool</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">layer1</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">layer2</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">layer3</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">layer4</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">avgpool</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">flatten</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#EEFFFF">        x </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">fc</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#EEFFFF"> x</span></span></code></pre>
              </div>
              <p>
                For example, the different network variants can be instantiated via the following
                functions.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="python"><code><span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> resnet18</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> ResNet</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#82AAFF"> ResNet</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">BasicBlock</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> num_classes</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">num_classes</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> resnet34</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> ResNet</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#82AAFF"> ResNet</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">BasicBlock</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 6</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> num_classes</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">num_classes</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> resnet50</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> ResNet</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#82AAFF"> ResNet</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">Bottleneck</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 6</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> num_classes</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">num_classes</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> resnet101</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> ResNet</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#82AAFF"> ResNet</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">Bottleneck</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 23</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> num_classes</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">num_classes</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">def</span><span style="color:#82AAFF"> resnet152</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF;font-style:italic">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> ResNet</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    return</span><span style="color:#82AAFF"> ResNet</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">Bottleneck</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 36</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF;font-style:italic"> num_classes</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">num_classes</span><span style="color:#89DDFF">)</span></span></code></pre>
              </div>
              <p>
                In Mabor, we can instead use a trait bound for our <code>ResidualBlock</code> to be specified
                for the concrete implementations.
              </p>
              <details>
                <summary> <code>model/resnet.rs</code> </summary>
                <p>The ResNet module requires the following imports.</p>
                <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                  <pre class="astro-code material-theme-darker"
                    style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#F78C6C">  use</span><span style="color:#FFCB6B"> mabor</span><span style="color:#89DDFF">::{</span></span>
<span class="line"><span style="color:#FFCB6B">    module</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#FFCB6B">    nn</span><span style="color:#89DDFF">::{</span></span>
<span class="line"><span style="color:#FFCB6B">        conv</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">Conv2d</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#FFCB6B">        pool</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">AdaptiveAvgPool2d</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> AdaptiveAvgPool2dConfig</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> MaxPool2d</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> MaxPool2dConfig</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#FFCB6B">        BatchNorm</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Linear</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> LinearConfig</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> PaddingConfig2d</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    },</span></span>
<span class="line"><span style="color:#FFCB6B">    tensor</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">backend</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Device</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#EEFFFF"> super</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">block</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">BasicBlock</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Bottleneck</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> ResidualBlock</span><span style="color:#89DDFF">};</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
                </div>
              </details><br>
              <p>With that in mind, here's what the <code>ResNet</code> definition looks like.</p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/resnet.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF">#[</span><span style="color:#EEFFFF">derive</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Debug</span><span style="color:#89DDFF">)]</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> struct</span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#EEFFFF">    conv1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Conv2d</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    bn1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> BatchNorm</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    relu</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">    maxpool</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> MaxPool2d</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">    layer1</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    layer2</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    layer3</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    layer4</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    avgpool</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> AdaptiveAvgPool2d</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">    fc</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Linear</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> ResidualBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>></span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> M</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    fn</span><span style="color:#82AAFF"> new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">blocks</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> [</span><span style="color:#FFCB6B">usize</span><span style="color:#89DDFF">;</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // 7x7 conv, 64, /2</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> conv1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Conv2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF">],</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">7</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 7</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_stride</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_bias</span><span style="color:#89DDFF">(false)</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> bn1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> BatchNormConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> relu </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Relu</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">();</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // 3x3 maxpool, /2</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> maxpool </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> MaxPool2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_strides</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">with_padding</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">PaddingConfig2d</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">Explicit</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF">            .</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Residual blocks</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> layer1 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">blocks</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">],</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> layer2 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">blocks</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">],</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 128</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> layer3 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">blocks</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">],</span><span style="color:#F78C6C"> 128</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 256</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> layer4 </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LayerBlock</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">blocks</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">],</span><span style="color:#F78C6C"> 256</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 512</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Average pooling [B, 512 * expansion, H, W] -> [B, 512 * expansion, 1, 1]</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> avgpool </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> AdaptiveAvgPool2dConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">]).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Output layer</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> fc </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LinearConfig</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">512</span><span style="color:#89DDFF"> *</span><span style="color:#EEFFFF"> expansion</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">init</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">            conv1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            bn1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            relu</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            maxpool</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            layer1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            layer2</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            layer3</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            layer4</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            avgpool</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">            fc</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">        }</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 2</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // First block</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">conv1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">input</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">bn1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">relu</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">maxpool</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Residual blocks</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">layer1</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">layer2</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">layer3</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">layer4</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">avgpool</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Reshape [B, C, 1, 1] -> [B, C]</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> out</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">flatten</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#EEFFFF">        self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">fc</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">out</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
              </div>
              <p>
                Then, we implement the different methods to instantiate the network variants. Since we
                didn't mark the <code>new()</code> method as public, the only public interface to instantiate
                a concrete <code>ResNet</code> module is via the methods defined below.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/resnet.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> BasicBlock</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> resnet18</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">        Self</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> resnet34</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">        Self</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 6</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Bottleneck</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> resnet50</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">        Self</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 6</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> resnet101</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">        Self</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 23</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> resnet152</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">num_classes</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#EEFFFF">        Self</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 36</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span><span style="color:#EEFFFF"> num_classes</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 4</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
              </div>
              <p>Congratulations, you have now defined the infamous ResNet architecture in Mabor!</p>
              <p>Let's take a look at how you can import the pre-trained PyTorch weights in Mabor next.</p>
              <h2 id="import-weights">Importing Pre-trained PyTorch Weights</h2>
              <p>
                Mabor has support to import PyTorch weights directly into your Mabor module definition, so
                let's take advantage of that!
              </p>
              <p>
                As you may know, PyTorch saves the weights as a (flattened) state dictionary<span
                  class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-10">10</a><!--/-->]</span> that maps each layer name to its parameter tensor. To
                load the weights correctly, the same
                layer names must be found in your module definition.
              </p>
              <p>
                If the structure or names don't match up exactly, do not worry. The
                <code>PyTorchFileRecorder</code><span class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-11">11</a><!--/-->]</span>
                provides a way to remap layer names to your new definition. You probably already noticed that
                our layer names aren't a 1-to-1 match with the PyTorch definition, so we will actually be using
                this utility in this tutorial.
              </p>
              <p>
                For this example, we'll use the ResNet-18 pre-trained weights from <code>torchvision</code>. You can
                download the weights from <u><a href="../../models/resnet18-f37072fd.pth">this url</a></u>.
              </p>
              <p>
                The first discrepancy with our module definition is that the projection shortcut (i.e.,
                <code>Downsample</code>) block is explicitly defined, whereas in the <code>torchvision</code>
                implementation it is added "on-the-fly" as a <code>nn.Sequential</code> containing a convolutional
                layer and a batch normalization layer. Concretely, we want to map any <code>downsample.0</code> instance
                to a
                <code>downsample.conv</code> and any <code>downsample.1</code> to a <code>downsample.bn</code>. For
                that, we can use the
                <code>with_key_remap</code> method provided by the <code>PyTorchFileRecorder</code>'s load
                arguments which supports key replacement via a regular expression<span
                  class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-12">12</a><!--/-->]</span>.
              </p>
              <p>For the downsample block re-mapping, it would look something like this:</p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> load_args </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LoadArgs</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">weights_path</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // Map *.downsample.0.* -> *.downsample.conv.*</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">with_key_remap</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">(.+)</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">downsample</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">0</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">(.+)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">$1.downsample.conv.$2</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // Map *.downsample.1.* -> *.downsample.bn.*</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">with_key_remap</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">(.+)</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">downsample</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">1</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">(.+)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">$1.downsample.bn.$2</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
              </div>
              <p>
                \ Another discrepancy related to another <code>nn.Sequential</code> block also exists in our
                module definition. Recall that we instead defined a <code>LayerBlock</code> containing a vector
                of residual blocks, therefore we must adjust the mapping for any layer block. For example,
                all blocks in <code>layer1</code> should map from <code>layer1.[block_idx].*</code> to
                <code>layer1.blocks.[block_idx].*</code>.
              </p>
              <p>
                To generalize this to all layer blocks (i.e., <code>layer1</code>, <code>layer2</code>,
                <code>layer3</code> and <code>layer4</code>), it would look something like this:
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> load_args </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LoadArgs</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">weights_path</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // Map layer[i].[j].* -> layer[i].blocks.[j].*</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">with_key_remap</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">(layer[1-4])</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">([0-9]+)</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">(.+)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">$1.blocks.$2.$3</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
              </div>
              <p>
                With the combined patterns we just described, the pre-trained ResNet-18 weights can be
                imported in our main program as follows.
              </p>
              <details>
                <summary> <code>main.rs</code> </summary>
                <p>The main program requires the following imports.</p>
                <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                  <pre class="astro-code material-theme-darker"
                    style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// NOTE: we used `resnet_mabor` as the library crate name but you can replace it with your crate name</span></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#FFCB6B"> resnet_mabor</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">model</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">imagenet</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> resnet</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">ResNet</span><span style="color:#89DDFF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#FFCB6B"> mabor</span><span style="color:#89DDFF">::{</span></span>
<span class="line"><span style="color:#FFCB6B">    backend</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">NdArray</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#FFCB6B">    module</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#FFCB6B">    record</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">FullPrecisionSettings</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> NamedMpkFileRecorder</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Recorder</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#FFCB6B">    tensor</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">backend</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Device</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Element</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> TensorData</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#FFCB6B"> mabor_import</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">pytorch</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">LoadArgs</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> PyTorchFileRecorder</span><span style="color:#89DDFF">};</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
                </div>
              </details><br>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> TORCH_WEIGHTS</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">str</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">resnet18-f37072fd.pth</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">fn</span><span style="color:#82AAFF"> main</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#545454;font-style:italic">    // Create ResNet-18 for ImageNet (1k classes)</span></span>
<span class="line"><span style="color:#C792EA">    let</span><span style="color:#EEFFFF"> device </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Default</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">default</span><span style="color:#89DDFF">();</span></span>
<span class="line"><span style="color:#C792EA">    let</span><span style="color:#EEFFFF"> model</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">NdArray</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> _</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> =</span><span style="color:#FFCB6B"> ResNet</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">resnet18</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1000</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">    // Load weights from torch state_dict</span></span>
<span class="line"><span style="color:#C792EA">    let</span><span style="color:#EEFFFF"> load_args </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> LoadArgs</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">TORCH_WEIGHTS</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">into</span><span style="color:#89DDFF">())</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Map *.downsample.0.* -> *.downsample.conv.*</span></span>
<span class="line"><span style="color:#89DDFF">        .</span><span style="color:#82AAFF">with_key_remap</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">(.+)</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">downsample</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">0</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">(.+)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">$1.downsample.conv.$2</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Map *.downsample.1.* -> *.downsample.bn.*</span></span>
<span class="line"><span style="color:#89DDFF">        .</span><span style="color:#82AAFF">with_key_remap</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">(.+)</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">downsample</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">1</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">(.+)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">$1.downsample.bn.$2</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#545454;font-style:italic">        // Map layer[i].[j].* -> layer[i].blocks.[j].*</span></span>
<span class="line"><span style="color:#89DDFF">        .</span><span style="color:#82AAFF">with_key_remap</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">(layer[1-4])</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">([0-9]+)</span><span style="color:#EEFFFF">\.</span><span style="color:#C3E88D">(.+)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">$1.blocks.$2.$3</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">    let</span><span style="color:#EEFFFF"> record </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> PyTorchFileRecorder</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#FFCB6B">FullPrecisionSettings</span><span style="color:#89DDFF">>::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#89DDFF">        .</span><span style="color:#82AAFF">load</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">load_args</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">        .</span><span style="color:#82AAFF">expect</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Should load PyTorch model weights</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">    // `load_record` takes ownership of the model but we can re-assign the returned value</span></span>
<span class="line"><span style="color:#C792EA">    let</span><span style="color:#EEFFFF"> model </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">load_record</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">record</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
              </div>
              <p>
                Note that for this tutorial we are using the <code>NdArray</code> backend, but you can easily
                change that to any other supported backend.
              </p>
              <p>
                Before we test the pre-trained model we just imported, let's save it into one of Mabor's
                supported formats so we can load it without having to convert the state dictionary every
                time.
              </p>
              <h2 id="saving-loading">Saving and Loading Pre-trained Weights with Mabor</h2>
              <p>
                It's time to take a page straight out of the Mabor Book<span class="reference px-1">[<!--$--><a
                    class="hover:text-[#69b8e1]" href="#reference-13">13</a><!--/-->]</span> to save the pre-trained
                model we just imported to a supported format with one of the <code>Recorder</code><span
                  class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                    href="#reference-14">14</a><!--/-->]</span>s. In this example we'll use the default
                <code>NamedMpkFileRecorder</code>.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Save the model to a supported format and load it back</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> MODEL_PATH</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">str</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">resnet18-ImageNet1k</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> recorder </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> NamedMpkFileRecorder</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#FFCB6B">FullPrecisionSettings</span><span style="color:#89DDFF">>::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">();</span></span>
<span class="line"><span style="color:#EEFFFF">model</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">clone</span><span style="color:#89DDFF">()</span><span style="color:#545454;font-style:italic"> // `save_file` takes ownership but we want to load the file after</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">save_file</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">MODEL_PATH</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">recorder</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">expect</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Should be able to save weights to file</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> model </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> model</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">load_file</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">MODEL_PATH</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">recorder</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    .</span><span style="color:#82AAFF">expect</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Should be able to load weights from file</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#EEFFFF">  </span></span></code></pre>
              </div>
              <p>
                That's it! It's as simple as that. Be advised that in this particular case we had to
                <code>clone()</code> the model when we saved it but that's only because <code>save_file</code> takes
                ownership of the model and we actually still want to use it after saving it. In your
                typical application, you most likely won't need to do that since the saving and loading are
                usually done separately. Note that cloning only increases the reference count on parameters,
                no tensor data is actually copied here.
              </p>
              <p>We're now ready to load a sample image for inference.</p>
              <h2 id="load-image">Loading and Preparing a Sample Image</h2>
              <p>
                For this example, we'll use <u><a
                    href="https://commons.wikimedia.org/wiki/File:YellowLabradorLooking_new.jpg">this image</a></u> of a
                yellow Labrador retriever as it is one of the <u><a
                    href="https://github.com/tracel-ai/models/blob/main/resnet-burn/examples/inference/src/imagenet.rs">ImageNet
                    classes</a></u>.
              </p>
              <p>
                With the help of the <code>image</code> crate<span class="reference px-1">[<!--$--><a
                    class="hover:text-[#69b8e1]" href="#reference-15">15</a><!--/-->]</span>, loading an image from disk
                is fairly straightforward.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Load image</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> img_path </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> std</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">env</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">args</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">nth</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">expect</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">No image path provided</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> img </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> image</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">open</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">img_path</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">expect</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Should be able to load image</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span></code></pre>
              </div>
              <p>
                Following the training pre-processing operations, the image should be resized to 224×224
                and normalized using the ImageNet statistics.
              </p>
              <p>Let's start by resizing the image to the correct spatial dimensions.</p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Resize to 224x224</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> HEIGHT</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 224</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> WIDTH</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 224</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> resized_img </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> img</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">resize_exact</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#EEFFFF">    WIDTH </span><span style="color:#F78C6C">as</span><span style="color:#FFCB6B"> u32</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">    HEIGHT </span><span style="color:#F78C6C">as</span><span style="color:#FFCB6B"> u32</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#FFCB6B">    image</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">imageops</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">FilterType</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Triangle</span><span style="color:#89DDFF">,</span><span style="color:#545454;font-style:italic"> // also known as bilinear in 2D</span></span>
<span class="line"><span style="color:#89DDFF">);</span></span></code></pre>
              </div>
              <p>
                To create a tensor from the image data, we'll define a function <code>to_tensor</code> that
                will also convert the image tensor to channels first <code>[C, H, W]</code> and divide the
                values by <code>255</code> to normalize between <code>[0, 1]</code>. While we're at it,
                we'll add a batch dimension <code>B</code> of size one.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">fn</span><span style="color:#82AAFF"> to_tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> T</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Element</span><span style="color:#89DDFF">>(</span></span>
<span class="line"><span style="color:#EEFFFF">    data</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Vec</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">T</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#EEFFFF">    shape</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> [</span><span style="color:#FFCB6B">usize</span><span style="color:#89DDFF">;</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span></span>
<span class="line"><span style="color:#EEFFFF">    device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 3</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#82AAFF">    Tensor</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">>::</span><span style="color:#82AAFF">from_data</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">TensorData</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">data</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> shape</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">convert</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">FloatElem</span><span style="color:#89DDFF">>(),</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">        .</span><span style="color:#82AAFF">permute</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">])</span><span style="color:#545454;font-style:italic"> // [C, H, W]</span></span>
<span class="line"><span style="color:#89DDFF">        /</span><span style="color:#F78C6C"> 255</span><span style="color:#545454;font-style:italic"> // normalize between [0, 1]</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Create tensor from image data</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> img_tensor</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">NdArray</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> to_tensor</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#EEFFFF">    resized_img</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">into_rgb8</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">into_raw</span><span style="color:#89DDFF">(),</span></span>
<span class="line"><span style="color:#89DDFF">    [</span><span style="color:#EEFFFF">HEIGHT</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> WIDTH</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">],</span></span>
<span class="line"><span style="color:#89DDFF">    &#x26;</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">.</span><span style="color:#82AAFF">unsqueeze</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#F78C6C">4</span><span style="color:#89DDFF">>();</span><span style="color:#545454;font-style:italic"> // [B, C, H, W]</span></span></code></pre>
              </div>
              <p>
                Now that we have an image tensor of shape <code>[1, 3, 224, 224]</code>, we can apply
                per-channel normalization with the ImageNet mean and standard deviation values.
              </p>
              <details>
                <summary> <code>model/imagenet.rs</code> </summary>
                <p>The ImageNet utilities module requires the following imports.</p>
                <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                  <pre class="astro-code material-theme-darker"
                    style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                    data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#F78C6C">use</span><span style="color:#FFCB6B"> mabor</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">tensor</span><span style="color:#89DDFF">::{</span><span style="color:#FFCB6B">backend</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Backend</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Device</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">};</span></span></code></pre>
                </div>
              </details><br>
              <p>
                Since this is something we might want to reuse in the future, we'll define a <code>Normalizer</code>
                with the correct ImageNet statistics.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/imagenet.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Pre-computed mean and standard deviation on ImageNet dataset.</span></span>
<span class="line"><span style="color:#545454;font-style:italic">// Source: https://github.com/pytorch/vision/blob/main/torchvision/transforms/_presets.py#L44-L45</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> MEAN</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> [</span><span style="color:#FFCB6B">f32</span><span style="color:#89DDFF">;</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">.</span><span style="color:#F78C6C">485</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">.</span><span style="color:#F78C6C">456</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">.</span><span style="color:#F78C6C">406</span><span style="color:#89DDFF">];</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#EEFFFF"> STD</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> [</span><span style="color:#FFCB6B">f32</span><span style="color:#89DDFF">;</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">.</span><span style="color:#F78C6C">229</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">.</span><span style="color:#F78C6C">224</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">.</span><span style="color:#F78C6C">225</span><span style="color:#89DDFF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">/// Normalizer for the ImageNet dataset.</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> struct</span><span style="color:#FFCB6B"> Normalizer</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#EEFFFF"> mean</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#EEFFFF"> std</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>,</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">impl</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Backend</span><span style="color:#89DDFF">></span><span style="color:#FFCB6B"> Normalizer</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> new</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> &#x26;</span><span style="color:#FFCB6B">Device</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#EEFFFF"> Self </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> mean </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">>::</span><span style="color:#82AAFF">from_floats</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">MEAN</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">reshape</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">]);</span></span>
<span class="line"><span style="color:#C792EA">        let</span><span style="color:#EEFFFF"> std </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">::&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">>::</span><span style="color:#82AAFF">from_floats</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">STD</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> device</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">reshape</span><span style="color:#89DDFF">([</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">]);</span></span>
<span class="line"><span style="color:#EEFFFF">        Self </span><span style="color:#89DDFF">{</span><span style="color:#EEFFFF"> mean</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> std </span><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C">    pub</span><span style="color:#F78C6C"> fn</span><span style="color:#82AAFF"> normalize</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">self</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> input</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">>)</span><span style="color:#89DDFF"> -></span><span style="color:#FFCB6B"> Tensor</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">B</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> 4</span><span style="color:#89DDFF">></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#89DDFF">        (</span><span style="color:#EEFFFF">input </span><span style="color:#89DDFF">-</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">mean</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">clone</span><span style="color:#89DDFF">())</span><span style="color:#89DDFF"> /</span><span style="color:#EEFFFF"> self</span><span style="color:#89DDFF">.</span><span style="color:#EEFFFF">std</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">clone</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>
              </div>
              <p>We can use it in our main program now to normalize the image tensor.</p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Normalize the image</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> x </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> imagenet</span><span style="color:#89DDFF">::</span><span style="color:#FFCB6B">Normalizer</span><span style="color:#89DDFF">::</span><span style="color:#82AAFF">new</span><span style="color:#89DDFF">(&#x26;</span><span style="color:#EEFFFF">device</span><span style="color:#89DDFF">).</span><span style="color:#82AAFF">normalize</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">img_tensor</span><span style="color:#89DDFF">);</span></span></code></pre>
              </div>
              <p>The pre-processed image is now ready to be passed to our ResNet-18 for inference.</p>
              <h2 id="inference">Performing Inference</h2>
              <p>
                We're done setting the stage. The pre-trained model has been loaded and the image tensor
                has been pre-processed. Let's look at how the network performs on a sample image.
              </p>
              <p>
                Note that the sample below doesn't define the <code>CLASSES</code> constant as it holds the
                1000 ImageNet categories. To complete your code sample, check out the collapsible source below.
              </p>
              <details>
                <summary> <code>imagenet::CLASSES</code> </summary>
                <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                  <pre class="astro-code material-theme-darker"
                    style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: model/imagenet.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// ImageNet categories</span></span>
<span class="line"><span style="color:#F78C6C">pub</span><span style="color:#C792EA"> const</span><span style="color:#EEFFFF"> CLASSES</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> [&#x26;</span><span style="color:#FFCB6B">str</span><span style="color:#89DDFF">;</span><span style="color:#F78C6C"> 1000</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> [</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tench</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">goldfish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">great white shark</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tiger shark</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hammerhead</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">electric ray</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stingray</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hen</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ostrich</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">brambling</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">goldfinch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">house finch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">junco</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">indigo bunting</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">robin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bulbul</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jay</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">magpie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chickadee</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">water ouzel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">kite</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bald eagle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vulture</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">great grey owl</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">European fire salamander</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">common newt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">eft</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spotted salamander</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">axolotl</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bullfrog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tree frog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tailed frog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">loggerhead</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">leatherback turtle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mud turtle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">terrapin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">box turtle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">banded gecko</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">common iguana</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American chameleon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">whiptail</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">agama</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">frilled lizard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">alligator lizard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Gila monster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">green lizard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">African chameleon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Komodo dragon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">African crocodile</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American alligator</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">triceratops</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">thunder snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ringneck snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hognose snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">green snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">king snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">garter snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">water snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vine snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">night snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">boa constrictor</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rock python</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Indian cobra</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">green mamba</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sea snake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">horned viper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">diamondback</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sidewinder</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trilobite</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">harvestman</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">scorpion</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black and gold garden spider</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barn spider</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">garden spider</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black widow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tarantula</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wolf spider</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">centipede</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black grouse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ptarmigan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ruffed grouse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">prairie chicken</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">peacock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">quail</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">partridge</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">African grey</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">macaw</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sulphur-crested cockatoo</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lorikeet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coucal</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bee eater</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hornbill</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hummingbird</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jacamar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toucan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">drake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">red-breasted merganser</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">goose</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black swan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tusker</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">echidna</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">platypus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wallaby</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">koala</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wombat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jellyfish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sea anemone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">brain coral</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">flatworm</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">nematode</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">conch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">snail</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">slug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sea slug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chiton</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chambered nautilus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Dungeness crab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rock crab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fiddler crab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">king crab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American lobster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spiny lobster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crayfish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hermit crab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">isopod</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">white stork</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black stork</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spoonbill</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">flamingo</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">little blue heron</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American egret</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bittern</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crane bird</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">limpkin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">European gallinule</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American coot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bustard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ruddy turnstone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">red-backed sandpiper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">redshank</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dowitcher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">oystercatcher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pelican</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">king penguin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">albatross</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">grey whale</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">killer whale</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dugong</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sea lion</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Chihuahua</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Japanese spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Maltese dog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Pekinese</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Shih-Tzu</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Blenheim spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">papillon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toy terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Rhodesian ridgeback</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Afghan hound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">basset</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beagle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bloodhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bluetick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black-and-tan coonhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Walker hound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">English foxhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">redbone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">borzoi</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Irish wolfhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Italian greyhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">whippet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Ibizan hound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Norwegian elkhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">otterhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Saluki</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Scottish deerhound</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Weimaraner</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Staffordshire bullterrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American Staffordshire terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Bedlington terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Border terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Kerry blue terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Irish terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Norfolk terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Norwich terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Yorkshire terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wire-haired fox terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Lakeland terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Sealyham terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Airedale</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cairn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Australian terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Dandie Dinmont</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Boston bull</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">miniature schnauzer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">giant schnauzer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">standard schnauzer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Scotch terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Tibetan terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">silky terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">soft-coated wheaten terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">West Highland white terrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Lhasa</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">flat-coated retriever</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">curly-coated retriever</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">golden retriever</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Labrador retriever</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Chesapeake Bay retriever</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">German short-haired pointer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vizsla</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">English setter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Irish setter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Gordon setter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Brittany spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">clumber</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">English springer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Welsh springer spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cocker spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Sussex spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Irish water spaniel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">kuvasz</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">schipperke</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">groenendael</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">malinois</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">briard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">kelpie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">komondor</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Old English sheepdog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Shetland sheepdog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">collie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Border collie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Bouvier des Flandres</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Rottweiler</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">German shepherd</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Doberman</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">miniature pinscher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Greater Swiss Mountain dog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Bernese mountain dog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Appenzeller</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">EntleBucher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">boxer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bull mastiff</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Tibetan mastiff</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">French bulldog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Great Dane</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Saint Bernard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Eskimo dog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">malamute</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Siberian husky</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dalmatian</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">affenpinscher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">basenji</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Leonberg</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Newfoundland</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Great Pyrenees</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Samoyed</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Pomeranian</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">keeshond</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Brabancon griffon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Pembroke</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Cardigan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toy poodle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">miniature poodle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">standard poodle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Mexican hairless</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">timber wolf</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">white wolf</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">red wolf</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coyote</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dingo</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dhole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">African hunting dog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hyena</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">red fox</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">kit fox</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Arctic fox</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">grey fox</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tabby</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tiger cat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Persian cat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Siamese cat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Egyptian cat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cougar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lynx</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">leopard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">snow leopard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jaguar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lion</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tiger</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cheetah</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">brown bear</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">American black bear</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ice bear</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sloth bear</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mongoose</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">meerkat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tiger beetle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ladybug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ground beetle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">long-horned beetle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">leaf beetle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dung beetle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rhinoceros beetle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">weevil</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fly</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bee</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ant</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">grasshopper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cricket</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">walking stick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cockroach</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mantis</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cicada</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">leafhopper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lacewing</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dragonfly</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">damselfly</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">admiral</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ringlet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">monarch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cabbage butterfly</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sulphur butterfly</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lycaenid</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">starfish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sea urchin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sea cucumber</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wood rabbit</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hare</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Angora</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hamster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">porcupine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fox squirrel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">marmot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beaver</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">guinea pig</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sorrel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">zebra</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wild boar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">warthog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hippopotamus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ox</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">water buffalo</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bison</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ram</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bighorn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ibex</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hartebeest</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">impala</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gazelle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Arabian camel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">llama</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">weasel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mink</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">polecat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">black-footed ferret</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">otter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">skunk</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">badger</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">armadillo</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">three-toed sloth</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">orangutan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gorilla</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chimpanzee</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gibbon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">siamang</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">guenon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">patas</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">baboon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">macaque</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">langur</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">colobus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">proboscis monkey</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">marmoset</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">capuchin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">howler monkey</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">titi</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spider monkey</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">squirrel monkey</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Madagascar cat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">indri</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Indian elephant</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">African elephant</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lesser panda</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">giant panda</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barracouta</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">eel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coho</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rock beauty</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">anemone fish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sturgeon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lionfish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">puffer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">abacus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">abaya</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">academic gown</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">accordion</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">acoustic guitar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">aircraft carrier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">airliner</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">airship</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">altar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ambulance</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">amphibian</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">analog clock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">apiary</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">apron</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ashcan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">assault rifle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">backpack</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bakery</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">balance beam</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">balloon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ballpoint</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Band Aid</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">banjo</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bannister</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barbell</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barber chair</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barbershop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barometer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barrel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">barrow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">baseball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">basketball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bassinet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bassoon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bathing cap</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bath towel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bathtub</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beach wagon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beacon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beaker</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bearskin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beer bottle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">beer glass</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bell cote</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bib</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bicycle-built-for-two</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bikini</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">binder</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">binoculars</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">birdhouse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">boathouse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bobsled</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bolo tie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bonnet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bookcase</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bookshop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bottlecap</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bow tie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">brass</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">brassiere</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">breakwater</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">breastplate</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">broom</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bucket</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">buckle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bulletproof vest</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bullet train</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">butcher shop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">caldron</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">candle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cannon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">canoe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">can opener</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cardigan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">car mirror</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">carousel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">carpenter's kit</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">carton</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">car wheel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cash machine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cassette</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cassette player</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">castle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">catamaran</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">CD player</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cello</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cellular telephone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chain</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chainlink fence</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chain mail</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chain saw</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chest</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chiffonier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chime</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">china cabinet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Christmas stocking</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">church</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cinema</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cleaver</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cliff dwelling</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cloak</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">clog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cocktail shaker</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coffee mug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coffeepot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coil</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">combination lock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">computer keyboard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">confectionery</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">container ship</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">convertible</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">corkscrew</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cornet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cowboy boot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cowboy hat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cradle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crane</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crash helmet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crate</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crib</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Crock Pot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">croquet ball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crutch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cuirass</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dam</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">desk</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">desktop computer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dial telephone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">diaper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">digital clock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">digital watch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dining table</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dishrag</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dishwasher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">disk brake</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dogsled</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dome</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">doormat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">drilling platform</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">drum</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">drumstick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dumbbell</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Dutch oven</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">electric fan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">electric guitar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">electric locomotive</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">entertainment center</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">envelope</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">espresso maker</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">face powder</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">feather boa</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">file</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fireboat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fire engine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fire screen</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">flagpole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">flute</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">folding chair</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">football helmet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">forklift</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fountain</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fountain pen</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">four-poster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">freight car</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">French horn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">frying pan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fur coat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">garbage truck</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gasmask</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gas pump</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">goblet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">go-kart</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">golf ball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">golfcart</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gondola</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gong</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gown</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">grand piano</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">greenhouse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">grille</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">grocery store</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">guillotine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hair slide</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hair spray</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">half track</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hammer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hamper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hand blower</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hand-held computer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">handkerchief</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hard disc</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">harmonica</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">harp</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">harvester</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hatchet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">holster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">home theater</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">honeycomb</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hook</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hoopskirt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">horizontal bar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">horse cart</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hourglass</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">iPod</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">iron</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jack-o'-lantern</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jean</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jeep</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jersey</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jigsaw puzzle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jinrikisha</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">joystick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">kimono</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">knee pad</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">knot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lab coat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ladle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lampshade</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">laptop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lawn mower</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lens cap</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">letter opener</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">library</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lifeboat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lighter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">limousine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">liner</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lipstick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Loafer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lotion</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">loudspeaker</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">loupe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lumbermill</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">magnetic compass</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mailbag</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mailbox</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">maillot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">maillot tank suit</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">manhole cover</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">maraca</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">marimba</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mask</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">matchstick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">maypole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">maze</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">measuring cup</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">medicine chest</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">megalith</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">microphone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">microwave</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">military uniform</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">milk can</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">minibus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">miniskirt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">minivan</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">missile</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mitten</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mixing bowl</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mobile home</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Model T</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">modem</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">monastery</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">monitor</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">moped</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mortar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mortarboard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mosque</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mosquito net</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">motor scooter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mountain bike</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mountain tent</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mouse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mousetrap</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">moving van</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">muzzle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">nail</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">neck brace</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">necklace</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">nipple</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">notebook</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">obelisk</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">oboe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ocarina</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">odometer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">oil filter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">organ</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">oscilloscope</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">overskirt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">oxcart</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">oxygen mask</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">packet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">paddle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">paddlewheel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">padlock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">paintbrush</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pajama</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">palace</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">panpipe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">paper towel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">parachute</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">parallel bars</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">park bench</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">parking meter</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">passenger car</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">patio</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pay-phone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pedestal</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pencil box</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pencil sharpener</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">perfume</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Petri dish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">photocopier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pick</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pickelhaube</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">picket fence</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pickup</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pier</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">piggy bank</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pill bottle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pillow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ping-pong ball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pinwheel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pirate</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pitcher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">plane</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">planetarium</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">plastic bag</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">plate rack</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">plow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">plunger</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Polaroid camera</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">police van</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">poncho</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pool table</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pop bottle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">potter's wheel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">power drill</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">prayer rug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">printer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">prison</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">projectile</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">projector</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">puck</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">punching bag</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">purse</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">quill</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">quilt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">racer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">racket</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">radiator</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">radio</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">radio telescope</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rain barrel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">recreational vehicle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">reel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">reflex camera</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">refrigerator</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">remote control</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">restaurant</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">revolver</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rifle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rocking chair</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rotisserie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rubber eraser</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rugby ball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rule</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">running shoe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">safe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">safety pin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">saltshaker</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sandal</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sarong</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sax</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">scabbard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">scale</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">school bus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">schooner</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">scoreboard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">screen</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">screw</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">screwdriver</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">seat belt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sewing machine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shield</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shoe shop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shoji</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shopping basket</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shopping cart</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shovel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shower cap</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">shower curtain</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ski</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ski mask</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sleeping bag</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">slide rule</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sliding door</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">slot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">snorkel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">snowmobile</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">snowplow</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">soap dispenser</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">soccer ball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">solar dish</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sombrero</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">soup bowl</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">space bar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">space heater</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">space shuttle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spatula</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">speedboat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spider web</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spindle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sports car</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spotlight</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stage</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">steam locomotive</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">steel arch bridge</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">steel drum</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stethoscope</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stone wall</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stopwatch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stove</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">strainer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">streetcar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stretcher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">studio couch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stupa</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">submarine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">suit</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sundial</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sunglass</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sunglasses</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sunscreen</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">suspension bridge</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">swab</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sweatshirt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">swimming trunks</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">swing</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">switch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">syringe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">table lamp</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tank</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tape player</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">teapot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">teddy</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">television</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tennis ball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">thatch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">theater curtain</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">thimble</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">thresher</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">throne</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tile roof</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toaster</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tobacco shop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toilet seat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">torch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">totem pole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tow truck</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toyshop</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tractor</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trailer truck</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tray</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trench coat</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tricycle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trimaran</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tripod</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">triumphal arch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trolleybus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trombone</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">tub</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">turnstile</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">typewriter keyboard</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">umbrella</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">unicycle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">upright</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vacuum</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vase</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vault</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">velvet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vending machine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">vestment</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">viaduct</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">violin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">volleyball</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">waffle iron</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wall clock</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wallet</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wardrobe</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">warplane</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">washbasin</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">washer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">water bottle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">water jug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">water tower</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">whiskey jug</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">whistle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wig</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">window screen</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">window shade</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Windsor tie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wine bottle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wing</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wok</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wooden spoon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wool</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">worm fence</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">wreck</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">yawl</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">yurt</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">web site</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">comic book</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">crossword puzzle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">street sign</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">traffic light</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">book jacket</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">menu</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">plate</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">guacamole</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">consomme</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hot pot</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">trifle</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ice cream</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ice lolly</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">French loaf</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bagel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pretzel</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cheeseburger</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hotdog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mashed potato</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">head cabbage</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">broccoli</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cauliflower</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">zucchini</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">spaghetti squash</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">acorn squash</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">butternut squash</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cucumber</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">artichoke</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bell pepper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cardoon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">mushroom</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Granny Smith</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">strawberry</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">orange</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lemon</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">fig</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pineapple</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">banana</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">jackfruit</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">custard apple</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pomegranate</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hay</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">carbonara</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">chocolate sauce</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">dough</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">meat loaf</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">pizza</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">potpie</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">burrito</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">red wine</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">espresso</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cup</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">eggnog</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">alp</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bubble</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">cliff</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coral reef</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">geyser</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">lakeside</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">promontory</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">sandbar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">seashore</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">valley</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">volcano</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ballplayer</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">groom</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">scuba diver</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">rapeseed</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">daisy</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">yellow lady's slipper</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">corn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">acorn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hip</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">buckeye</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">coral fungus</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">agaric</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">gyromitra</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">stinkhorn</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">earthstar</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">hen-of-the-woods</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">bolete</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">ear</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">toilet tissue</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">];</span></span></code></pre>
                </div>
              </details><br>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// File: main.rs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Forward pass</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> out </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">forward</span><span style="color:#89DDFF">(</span><span style="color:#EEFFFF">x</span><span style="color:#89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545454;font-style:italic">// Output class index with score (raw)</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#89DDFF"> (</span><span style="color:#EEFFFF">score</span><span style="color:#89DDFF">,</span><span style="color:#EEFFFF"> idx</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> =</span><span style="color:#EEFFFF"> out</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">max_dim_with_indices</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">);</span></span>
<span class="line"><span style="color:#C792EA">let</span><span style="color:#EEFFFF"> idx </span><span style="color:#89DDFF">=</span><span style="color:#EEFFFF"> idx</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">into_scalar</span><span style="color:#89DDFF">()</span><span style="color:#F78C6C"> as</span><span style="color:#FFCB6B"> usize</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF">println!</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#89DDFF">    "</span><span style="color:#C3E88D">Predicted: </span><span style="color:#89DDFF">{}</span></span>
<span class="line"><span style="color:#C3E88D">Category Id: </span><span style="color:#89DDFF">{}</span></span>
<span class="line"><span style="color:#C3E88D">Score: </span><span style="color:#89DDFF">{</span><span style="color:#C3E88D">:.4</span><span style="color:#89DDFF">}"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#FFCB6B">    imagenet</span><span style="color:#89DDFF">::</span><span style="color:#EEFFFF">CLASSES</span><span style="color:#89DDFF">[</span><span style="color:#EEFFFF">idx</span><span style="color:#89DDFF">],</span></span>
<span class="line"><span style="color:#EEFFFF">    idx</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#EEFFFF">    score</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">into_scalar</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#89DDFF">);</span></span></code></pre>
              </div>
              <p>
                With the snippets collected from this tutorial, you should now be able to run the project
                executable. To test the inference on a sample image, you can download the sample image
                <u><a href="../../wikipedia/commons/2/26/YellowLabradorLooking_new.jpg">here</a></u> and run the command
                below.
              </p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="sh"><code><span class="line"></span>
<span class="line"><span style="color:#FFCB6B">cargo</span><span style="color:#C3E88D"> run</span><span style="color:#C3E88D"> --release</span><span style="color:#C3E88D"> YellowLabradorLooking_new.jpg</span></span></code></pre>
              </div>
              <p>Looks like the model recognized the dog correctly!</p>
              <div class="my-[8px] border-2 rounded border-[#212121] font-mono font-medium">
                <pre class="astro-code material-theme-darker"
                  style="background-color:#212121;color:#EEFFFF; overflow-x: auto;" tabindex="0"
                  data-language="sh"><code><span class="line"></span>
<span class="line"><span style="color:#FFCB6B">Predicted:</span><span style="color:#C3E88D"> Labrador</span><span style="color:#C3E88D"> retriever</span></span>
<span class="line"><span style="color:#FFCB6B">Category</span><span style="color:#C3E88D"> Id:</span><span style="color:#F78C6C"> 208</span></span>
<span class="line"><span style="color:#FFCB6B">Score:</span><span style="color:#F78C6C"> 14.4482</span></span></code></pre>
              </div>
              <p> <i>Note: There is no need to call <code>model.valid()</code> (the equivalent to PyTorch's
                  <code>.eval()</code>) here since we are not using an <code>AutodiffBackend</code><span
                    class="reference px-1">[<!--$--><a class="hover:text-[#69b8e1]"
                      href="#reference-16">16</a><!--/-->]</span>. Without the AutodiffBackend, no backward graph is
                  created and thus no gradients are
                  tracked. More importantly, nothing related to automatic differentiation is actually
                  compiled, keeping the code as lean as possible for inference with minimal dependencies.</i> </p>
              <p>
                If you want to use ResNet in your application, take a look at the official Mabor
                implementation <u><a href="https://github.com/tracel-ai/models/tree/main/resnet-burn">available on
                    GitHub</a></u>! It closely follows this tutorial's implementation but further extends it to provide
                an
                easy interface to load the pre-trained weights for the whole ResNet family of models.
              </p>
              <p>
                Still want more? Take a look at the <u><a href="https://burn.dev/burn-book/">Mabor Book</a></u> or any of
                our <u><a href="https://github.com/tracel-ai/burn/tree/main/examples">examples</a></u>. And if you have
                any questions or comments, don't hesitate do join our <u><a
                    href="https://discord.gg/uPEBbYYDB6">Discord</a></u>!
              </p>
            </div> <!--/--><!--$-->
            <div>
              <h2>References</h2><!--$-->
              <div>
                <div id="reference-1"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://dev.to/laggui/transitioning-from-pytorch-to-burn-45m"
                      target="_blank">1</a>]</span><span class="font-light font-serif">Transitioning From PyTorch to
                    Mabor</span></div>
                <div id="reference-2"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold" href="https://arxiv.org/abs/1512.03385"
                      target="_blank">2</a>]</span><span class="font-light font-serif">Deep Residual Learning for Image
                    Recognition</span></div>
                <div id="reference-3"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://github.com/pytorch/vision/blob/main/torchvision/models/resnet.py"
                      target="_blank">3</a>]</span><span class="font-light font-serif">[GitHub] ResNet
                    torchivison</span></div>
                <div id="reference-4"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold" href="https://paperswithcode.com/method/residual-block"
                      target="_blank">4</a>]</span><span class="font-light font-serif">Residual Block</span></div>
                <div id="reference-5"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://paperswithcode.com/method/bottleneck-residual-block"
                      target="_blank">5</a>]</span><span class="font-light font-serif">Bottleneck Residual Block</span>
                </div>
                <div id="reference-6"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://burn.dev/burn-book/building-blocks/module.html" target="_blank">6</a>]</span><span
                    class="font-light font-serif">[The Mabor Book] Building Blocks: Module</span></div>
                <div id="reference-7"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://burn.dev/burn-book/building-blocks/backend.html" target="_blank">7</a>]</span><span
                    class="font-light font-serif">[The Mabor Book] Building Blocks: Backend</span></div>
                <div id="reference-8"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://github.com/tracel-ai/models/tree/main/resnet-burn"
                      target="_blank">8</a>]</span><span class="font-light font-serif">[Mabor Models GitHub] ResNet
                    Mabor</span></div>
                <div id="reference-9"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://doc.rust-lang.org/std/marker/struct.PhantomData.html"
                      target="_blank">9</a>]</span><span class="font-light font-serif">PhantomData</span></div>
                <div id="reference-10"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://pytorch.org/tutorials/recipes/recipes/what_is_state_dict.html"
                      target="_blank">10</a>]</span><span class="font-light font-serif">What is a state_dict in
                    PyTorch</span></div>
                <div id="reference-11"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://docs.rs/burn-import/0.14.0/burn_import/pytorch/struct.PyTorchFileRecorder.html"
                      target="_blank">11</a>]</span><span class="font-light font-serif">PyTorchFileRecorder</span></div>
                <div id="reference-12"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://docs.rs/regex/latest/regex/struct.Regex.html#method.replace"
                      target="_blank">12</a>]</span><span class="font-light font-serif">Regex replace</span></div>
                <div id="reference-13"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold" href="https://burn.dev/burn-book/saving-and-loading.html"
                      target="_blank">13</a>]</span><span class="font-light font-serif">[The Mabor Book] Saving and
                    Loading Models</span></div>
                <div id="reference-14"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://burn.dev/burn-book/building-blocks/record.html#recorder"
                      target="_blank">14</a>]</span><span class="font-light font-serif">[The Mabor Book] Building Blocks:
                    Record</span></div>
                <div id="reference-15"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold" href="https://crates.io/crates/image"
                      target="_blank">15</a>]</span><span class="font-light font-serif">Image: An Image Processing
                    Library</span></div>
                <div id="reference-16"><span class="pr-2 font-light font-serif leading-7 tracking-wide">[<a
                      class="text-[#69b8e1] hover:font-bold"
                      href="https://burn.dev/burn-book/building-blocks/autodiff.html"
                      target="_blank">16</a>]</span><span class="font-light font-serif">[The Mabor Book] Building Blocks:
                    Autodiff</span></div>
              </div><!--/-->
            </div><!--/-->
          </div>
        </article>
      </div>
    </div>
  </main>
  <dialog
    class="items-center text-balance rounded-2xl border bg-transparent p-8 text-center backdrop-blur-md backdrop:bg-black/70 max-sm:mx-6 overflow-hidden"
    id="stay-connected-dialog">
    <h2 class="text-v2h2">Join the mailing list</h2>
    <p class="py-4 font-mono text-body"> Join our community! We&#39;d love to keep you in the loop with our newsletter.
    </p>
    <script>(() => { var a = (s, i, o) => { let r = async () => { await (await s())() }, t = typeof i.value == "object" ? i.value : void 0, c = { rootMargin: t == null ? void 0 : t.rootMargin }, n = new IntersectionObserver(e => { for (let l of e) if (l.isIntersecting) { n.disconnect(), r(); break } }, c); for (let e of o.children) n.observe(e) }; (self.Astro || (self.Astro = {})).visible = a; window.dispatchEvent(new Event("astro:visible")); })();</script>
    <astro-island uid="Z1fPhRT" data-solid-render-id="s0" component-url="/_astro/EmailCollector.BqSZQ7nP.js"
      component-export="EmailCollector" renderer-url="/_astro/client.C-0b9Jot.js"
      props="{&quot;website&quot;:[0,&quot;burn&quot;],&quot;inputId&quot;:[0,&quot;stay-connected&quot;],&quot;title&quot;:[0,&quot;Stay connected&quot;],&quot;submitTitle&quot;:[0,&quot;submit email&quot;],&quot;inputLabel&quot;:[0,&quot;email address&quot;],&quot;placeholder&quot;:[0,&quot;your em@il&quot;],&quot;bgAlt&quot;:[0,&quot;stay connected background&quot;],&quot;subscribed&quot;:[0,&quot;subscribed&quot;],&quot;unsubscribed&quot;:[0,&quot;unsubscribed&quot;],&quot;firebaseConfig&quot;:[0,{&quot;apiKey&quot;:[0,&quot;AIzaSyDtXjGAc35AxrqEa8Fdmz3E1sKIX7MfgzU&quot;],&quot;authDomain&quot;:[0,&quot;tracel-website.firebaseapp.com&quot;],&quot;projectId&quot;:[0,&quot;tracel-website&quot;],&quot;storageBucket&quot;:[0,&quot;tracel-website.appspot.com&quot;],&quot;messagingSenderId&quot;:[0,&quot;278977725843&quot;],&quot;appId&quot;:[0,&quot;1:278977725843:web:be459a460a35c455cb9466&quot;]}]}"
      ssr="" client="visible" opts="{&quot;name&quot;:&quot;EmailCollector&quot;,&quot;value&quot;:true}"
      await-children="">
      <form data-hk="s00000" name="stay-connected"><span class="flex items-center rounded-lg gap-2">
          <div class="relative w-full"><input
              class="w-full h-12 flex-1 rounded-md bg-black/20 pl-2 pr-6 text-xs transition-border-duration-700 placeholder:text-primary-content/40 focus:outline-2 border border-primary-content"
              id="stay-connected" placeholder="your em@il" name="email" autocomplete="email" type="email"
              aria-label="email address" required=""><output class="absolute right-5 top-1/2 -translate-y-1/2"
              name="subscribeStatus" for="stay-connected"><svg width="16px" viewbox="2 -11 9 10"
                xmlns="http://www.w3.org/2000/svg">
                <title>unsubscribed</title><text x="0" y="0" class="fill-green-700"></text>
              </svg></output></div><button class="primary-button rounded-md px-2 text-xl h-12 w-20 border border-white"
            title="submit email" type="submit">⇥</button>
        </span></form><!--astro:end-->
    </astro-island>
    <form class="absolute right-0 top-0" method="dialog"> <button class="rounded-md p-4" title="dismiss">
        ✕
      </button> </form>
  </dialog>
  <script>(function () {
      const id = "stay-connected";

      /* eslint-env browser */
      const setupModal = () => {
        if (location.hash === `#${id}`) {
          const dialog = document.getElementById(`${id}-dialog`);
          dialog.addEventListener(
            "close",
            () => {
              history.pushState(
                "",
                document.title,
                window.location.pathname + window.location.search,
              );
            },
            { once: true },
          );

          dialog.addEventListener("click", (e) => {
            const dialogDimensions = dialog.getBoundingClientRect();
            if (
              e.clientX < dialogDimensions.left ||
              e.clientX > dialogDimensions.right ||
              e.clientY < dialogDimensions.top ||
              e.clientY > dialogDimensions.bottom
            ) {
              dialog.close();
            }
          });

          dialog.showModal();
        }
      };

      document.addEventListener("readystatechange", (e) => {
        if (e.target.readyState === "interactive") {
          setupModal();
          window.addEventListener("popstate", setupModal);
        }
      });
    })();</script>
  <div class="flex w-full flex-col items-center gap-8 py-10 text-mid">
    <div class="w-full max-w-[1360px] px-8 md:px-20">
      <div
        class="grid w-full grid-cols-1 gap-8 md:gap-20 [@media(min-width:400px)]:grid-cols-2 [@media(min-width:768px)]:grid-cols-4">
        <div class="flex w-full flex-col text-center [@media(min-width:400px)]:text-left">
          <h3 class="text-nowrap text-h3 text-light">Resources</h3> <a href="../../index.htm"
            class="text-body text-grey-accent hover:text-light"> Home </a><a href="../../get-started/index.htm"
            class="text-body text-grey-accent hover:text-light"> Get Started </a><a
            href="../../benchmarks/community-benchmarks/index.htm" class="text-body text-grey-accent hover:text-light">
            Benchmarks </a><a href="../index.htm" class="text-body text-grey-accent hover:text-light"> Blog </a><a
            href="../../learn/index.htm" class="text-body text-grey-accent hover:text-light"> Learn </a><a
            href="../../docs/burn/index.htm" class="text-body text-grey-accent hover:text-light"> Docs </a>
        </div>
        <div class="flex w-full flex-col text-center [@media(min-width:400px)]:text-left">
          <h3 class="text-nowrap text-h3 text-light">Community</h3> <a href="https://github.com/tracel-ai/burn"
            class="text-body text-grey-accent hover:text-light"> Github </a><a href="https://discord.gg/uPEBbYYDB6"
            class="text-body text-grey-accent hover:text-light"> Discord </a><a href="#stay-connected"
            class="text-body text-grey-accent hover:text-light"> Mailing list </a><a href="https://tracel.ai"
            class="text-body text-grey-accent hover:text-light"> Tracel </a>
        </div>
        <div class="flex w-full flex-col text-center [@media(min-width:400px)]:text-left">
          <h3 class="text-nowrap text-h3 text-light">Projects</h3> <a href="https://crates.io/crates/burn"
            class="text-body text-grey-accent hover:text-light"> Mabor Crate </a><a
            href="https://github.com/tracel-ai/burn" class="text-body text-grey-accent hover:text-light"> Mabor GitHub
          </a><a href="https://crates.io/crates/cubecl" class="text-body text-grey-accent hover:text-light"> CubeCL
            Crate </a><a href="https://github.com/tracel-ai/cubecl" class="text-body text-grey-accent hover:text-light">
            CubeCL GitHub </a>
        </div>
        <div class="flex w-full flex-col text-center [@media(min-width:400px)]:text-left">
          <h3 class="text-nowrap text-h3 text-light">Company</h3> <a href="https://tracel.ai/"
            class="text-body text-grey-accent hover:text-light"> Tracel AI </a><a
            href="https://www.linkedin.com/company/tracel-technologies"
            class="text-body text-grey-accent hover:text-light"> LinkedIn </a><a href="https://x.com/tracel_ai"
            class="text-body text-grey-accent hover:text-light"> X </a>
        </div>
      </div>
    </div>
    <p class="mt-6 text-center font-mono text-b2 text-mid md:flex"> Copyright 2025 © Mabor | Tracel Inc. All rights
      reserved. Design by Perdomo </p>
  </div>
</body>

</html>